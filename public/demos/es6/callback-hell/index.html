<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å›è°ƒåœ°ç‹±é—®é¢˜</title>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.7.16/dist/vue.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    #app {
      max-width: 700px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    }
    h3 { color: #1d1d1f; margin-bottom: 16px; }
    .desc {
      color: #666;
      margin-bottom: 20px;
      line-height: 1.6;
      padding: 12px;
      background: #fff3e0;
      border-radius: 8px;
      border-left: 4px solid #ff9800;
    }
    .demo-section {
      margin-bottom: 24px;
      padding: 16px;
      background: #f5f5f7;
      border-radius: 12px;
    }
    .demo-section h4 {
      color: #333;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.3s;
      margin-right: 8px;
      margin-bottom: 8px;
    }
    .btn-primary { background: #007AFF; color: white; }
    .btn-primary:hover { background: #0056b3; }
    .btn-success { background: #34c759; color: white; }
    .btn-success:hover { background: #2da44e; }
    .log-box {
      margin-top: 16px;
      padding: 16px;
      background: #1d1d1f;
      border-radius: 8px;
      font-family: 'SF Mono', Monaco, monospace;
      font-size: 13px;
      color: #fff;
      max-height: 300px;
      overflow-y: auto;
    }
    .log-item {
      padding: 4px 0;
      border-bottom: 1px solid #333;
    }
    .log-item:last-child { border-bottom: none; }
    .log-time { color: #86868b; margin-right: 8px; }
    .log-step { color: #5ac8fa; }
    .log-data { color: #34c759; }
    .log-error { color: #ff3b30; }
    .code-preview {
      background: #2d2d2d;
      border-radius: 8px;
      padding: 16px;
      margin-top: 12px;
      font-family: 'SF Mono', Monaco, monospace;
      font-size: 12px;
      color: #e6e6e6;
      line-height: 1.6;
      overflow-x: auto;
    }
    .code-preview .comment { color: #6a9955; }
    .code-preview .keyword { color: #c586c0; }
    .code-preview .function { color: #dcdcaa; }
    .code-preview .string { color: #ce9178; }
    .indent-1 { padding-left: 20px; }
    .indent-2 { padding-left: 40px; }
    .indent-3 { padding-left: 60px; }
    .indent-4 { padding-left: 80px; }
    .warning-tag {
      display: inline-block;
      padding: 2px 8px;
      background: #ff3b30;
      color: white;
      border-radius: 4px;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <div id="app">
    <h3>ğŸŒ€ å›è°ƒåœ°ç‹±é—®é¢˜</h3>
    <p class="desc">
      <strong>ä»€ä¹ˆæ˜¯å›è°ƒåœ°ç‹±ï¼Ÿ</strong><br>
      å½“å¤šä¸ªå¼‚æ­¥æ“ä½œéœ€è¦æŒ‰é¡ºåºæ‰§è¡Œæ—¶ï¼Œä½¿ç”¨å›è°ƒå‡½æ•°ä¼šå¯¼è‡´ä»£ç ä¸æ–­åµŒå¥—ï¼Œå½¢æˆ"é‡‘å­—å¡”"å½¢çŠ¶ï¼Œè¿™å°±æ˜¯å›è°ƒåœ°ç‹±ï¼ˆCallback Hellï¼‰ã€‚
    </p>

    <!-- å›è°ƒåœ°ç‹±ç¤ºä¾‹ -->
    <div class="demo-section">
      <h4>âŒ å›è°ƒåœ°ç‹±ä»£ç  <span class="warning-tag">éš¾ä»¥ç»´æŠ¤</span></h4>
      <div class="code-preview">
        <div><span class="comment">// æ¨¡æ‹Ÿï¼šè·å–ç”¨æˆ· â†’ è·å–è®¢å• â†’ è·å–å•†å“ â†’ è·å–è¯„ä»·</span></div>
        <div><span class="function">getUser</span>(userId, <span class="keyword">function</span>(user) {</div>
        <div class="indent-1"><span class="function">getOrders</span>(user.id, <span class="keyword">function</span>(orders) {</div>
        <div class="indent-2"><span class="function">getProducts</span>(orders[0].id, <span class="keyword">function</span>(products) {</div>
        <div class="indent-3"><span class="function">getReviews</span>(products[0].id, <span class="keyword">function</span>(reviews) {</div>
        <div class="indent-4"><span class="comment">// ç»ˆäºæ‹¿åˆ°æ•°æ®äº†...ä½†ä»£ç å·²ç»åµŒå¥—4å±‚ï¼</span></div>
        <div class="indent-4">console.log(reviews);</div>
        <div class="indent-3">});</div>
        <div class="indent-2">});</div>
        <div class="indent-1">});</div>
        <div>});</div>
      </div>
      <button class="btn btn-primary" @click="runCallbackHell">è¿è¡Œå›è°ƒåœ°ç‹±ç¤ºä¾‹</button>
    </div>

    <!-- Promise è§£å†³æ–¹æ¡ˆé¢„è§ˆ -->
    <div class="demo-section">
      <h4>âœ… Promise é“¾å¼è°ƒç”¨ <span style="background:#34c759;color:white;padding:2px 8px;border-radius:4px;font-size:12px;">æ¸…æ™°æ˜“è¯»</span></h4>
      <div class="code-preview">
        <div><span class="comment">// Promise é“¾å¼è°ƒç”¨ï¼Œä»£ç æ‰å¹³åŒ–</span></div>
        <div><span class="function">getUser</span>(userId)</div>
        <div class="indent-1">.then(user => <span class="function">getOrders</span>(user.id))</div>
        <div class="indent-1">.then(orders => <span class="function">getProducts</span>(orders[0].id))</div>
        <div class="indent-1">.then(products => <span class="function">getReviews</span>(products[0].id))</div>
        <div class="indent-1">.then(reviews => console.log(reviews))</div>
        <div class="indent-1">.catch(err => console.error(err));</div>
      </div>
      <button class="btn btn-success" @click="runPromiseChain">è¿è¡Œ Promise é“¾å¼è°ƒç”¨</button>
    </div>

    <!-- æ‰§è¡Œæ—¥å¿— -->
    <div class="log-box" v-if="logs.length > 0">
      <div class="log-item" v-for="(log, index) in logs" :key="index">
        <span class="log-time">[{{ log.time }}]</span>
        <span :class="'log-' + log.type">{{ log.message }}</span>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>

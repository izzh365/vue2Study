<template>
  <div class="knowledge-page">
    <!-- ç« èŠ‚å¯¼èˆª -->
    <div class="page-header">
      <router-link to="/axios" class="back-link">â† è¿”å› Axios ç« èŠ‚</router-link>
      <h1>ğŸ“¡ 10.1 åŸºç¡€è¯·æ±‚</h1>
    </div>

    <!-- æ¦‚å¿µè¯´æ˜ -->
    <KnowledgeCard title="ğŸ“– æ¦‚å¿µè¯´æ˜">
      <div class="concept-content">
        <p class="analogy">
          <strong>é€šä¿—æ¯”å–»</strong>
          ï¼šAxios å°±åƒ<strong>å¿«é€’å‘˜</strong>
          â€”â€”ä½ å‘Šè¯‰ä»–è¦é€ä»€ä¹ˆï¼ˆè¯·æ±‚æ•°æ®ï¼‰ï¼Œé€åˆ°å“ªé‡Œï¼ˆURLï¼‰ï¼Œä»–å¸®ä½ é€è´§å¹¶å¸¦å›å›æ‰§ï¼ˆå“åº”ï¼‰ã€‚
        </p>
        <p class="definition">
          <strong>å®˜æ–¹å®šä¹‰</strong>
          ï¼šAxios æ˜¯ä¸€ä¸ªåŸºäº Promise çš„ HTTP å®¢æˆ·ç«¯ï¼Œå¯ç”¨äºæµè§ˆå™¨å’Œ Node.jsã€‚
          å®ƒæä¾›äº†ç®€æ´çš„ API æ¥å‘é€å„ç§ç±»å‹çš„ HTTP è¯·æ±‚ã€‚
        </p>
      </div>
    </KnowledgeCard>

    <!-- ä¸ºä»€ä¹ˆä½¿ç”¨ Axios -->
    <KnowledgeCard title="ğŸ’¡ ä¸ºä»€ä¹ˆä½¿ç”¨ Axios">
      <div class="why-content">
        <p>ç›¸æ¯”åŸç”Ÿçš„ <code>fetch</code> å’Œ <code>XMLHttpRequest</code>ï¼ŒAxios æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
        <ul class="feature-list">
          <li><strong>è‡ªåŠ¨è½¬æ¢ JSON</strong>ï¼šè¯·æ±‚å’Œå“åº”æ•°æ®è‡ªåŠ¨åºåˆ—åŒ–/ååºåˆ—åŒ–</li>
          <li><strong>æ‹¦æˆªå™¨æ”¯æŒ</strong>ï¼šå¯ä»¥åœ¨è¯·æ±‚å‘é€å‰å’Œå“åº”è¿”å›åè¿›è¡Œç»Ÿä¸€å¤„ç†</li>
          <li><strong>å–æ¶ˆè¯·æ±‚</strong>ï¼šæ”¯æŒå–æ¶ˆæ­£åœ¨è¿›è¡Œçš„è¯·æ±‚</li>
          <li><strong>è¶…æ—¶è®¾ç½®</strong>ï¼šæ–¹ä¾¿è®¾ç½®è¯·æ±‚è¶…æ—¶æ—¶é—´</li>
          <li><strong>XSRF é˜²æŠ¤</strong>ï¼šå†…ç½® XSRF é˜²æŠ¤æœºåˆ¶</li>
          <li><strong>æµè§ˆå™¨å…¼å®¹</strong>ï¼šå…¼å®¹ IE11+ï¼Œæ— éœ€ polyfill</li>
        </ul>
      </div>
    </KnowledgeCard>

    <!-- è¯­æ³•æ ¼å¼ -->
    <KnowledgeCard title="ğŸ“ è¯­æ³•æ ¼å¼">
      <CodeBlock :code="syntaxCode" language="javascript" />
      <div class="syntax-notes">
        <p><code>axios.get(url[, config])</code> - GET è¯·æ±‚</p>
        <p><code>axios.post(url[, data[, config]])</code> - POST è¯·æ±‚</p>
        <p><code>axios(config)</code> - é€šç”¨è¯·æ±‚æ–¹æ³•</p>
      </div>
    </KnowledgeCard>

    <!-- Demo 1: GET è¯·æ±‚ -->
    <KnowledgeCard title="ğŸ¯ Demo 1: GET è¯·æ±‚åŸºç¡€">
      <p class="demo-desc">ä½¿ç”¨ GET è¯·æ±‚è·å–æ•°æ®ï¼Œæ”¯æŒ params å‚æ•°ä¼ é€’ã€‚</p>
      <DemoBox demoPath="axios/get-basic" title="GET è¯·æ±‚ç¤ºä¾‹" height="420px" />
    </KnowledgeCard>

    <!-- Demo 2: POST è¯·æ±‚ -->
    <KnowledgeCard title="ğŸ¯ Demo 2: POST è¯·æ±‚åŸºç¡€">
      <p class="demo-desc">ä½¿ç”¨ POST è¯·æ±‚å‘é€æ•°æ®ï¼Œæ•°æ®æ”¾åœ¨è¯·æ±‚ä½“ä¸­ã€‚</p>
      <DemoBox demoPath="axios/post-basic" title="POST è¯·æ±‚ç¤ºä¾‹" height="450px" />
    </KnowledgeCard>

    <!-- Demo 3: è¯·æ±‚é…ç½® -->
    <KnowledgeCard title="ğŸ¯ Demo 3: è¯·æ±‚é…ç½®è¯¦è§£">
      <p class="demo-desc">Axios æä¾›äº†ä¸°å¯Œçš„é…ç½®é€‰é¡¹ï¼ŒåŒ…æ‹¬ headersã€timeoutã€baseURL ç­‰ã€‚</p>
      <DemoBox demoPath="axios/config-options" title="è¯·æ±‚é…ç½®ç¤ºä¾‹" height="500px" />
    </KnowledgeCard>

    <!-- Demo 4: è¯·æ±‚æ–¹æ³•åˆ«å -->
    <KnowledgeCard title="ğŸ¯ Demo 4: å…¶ä»–è¯·æ±‚æ–¹æ³•">
      <p class="demo-desc">Axios æ”¯æŒæ‰€æœ‰ HTTP æ–¹æ³•ï¼šPUTã€DELETEã€PATCH ç­‰ã€‚</p>
      <DemoBox demoPath="axios/methods" title="HTTP æ–¹æ³•æ¼”ç¤º" height="450px" />
    </KnowledgeCard>

    <!-- Demo 5: åˆ›å»ºå®ä¾‹ -->
    <KnowledgeCard title="ğŸ¯ Demo 5: åˆ›å»º Axios å®ä¾‹">
      <p class="demo-desc">ä½¿ç”¨ <code>axios.create()</code> åˆ›å»ºè‡ªå®šä¹‰å®ä¾‹ï¼Œæ¯ä¸ªå®ä¾‹æœ‰ç‹¬ç«‹é…ç½®ã€‚</p>
      <DemoBox demoPath="axios/create-instance" title="åˆ›å»ºå®ä¾‹ç¤ºä¾‹" height="480px" />
    </KnowledgeCard>

    <!-- å¸¸ç”¨é…ç½®é€‰é¡¹ -->
    <KnowledgeCard title="âš™ï¸ å¸¸ç”¨é…ç½®é€‰é¡¹">
      <table class="config-table">
        <thead>
          <tr>
            <th>é…ç½®é¡¹</th>
            <th>ç±»å‹</th>
            <th>è¯´æ˜</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>url</code></td>
            <td>String</td>
            <td>è¯·æ±‚åœ°å€ï¼ˆå¿…å¡«ï¼‰</td>
          </tr>
          <tr>
            <td><code>method</code></td>
            <td>String</td>
            <td>è¯·æ±‚æ–¹æ³•ï¼Œé»˜è®¤ 'get'</td>
          </tr>
          <tr>
            <td><code>baseURL</code></td>
            <td>String</td>
            <td>åŸºç¡€ URLï¼Œä¼šè‡ªåŠ¨æ‹¼æ¥åœ¨ url å‰é¢</td>
          </tr>
          <tr>
            <td><code>params</code></td>
            <td>Object</td>
            <td>URL å‚æ•°ï¼ˆç”¨äº GET è¯·æ±‚ï¼‰</td>
          </tr>
          <tr>
            <td><code>data</code></td>
            <td>Object/String</td>
            <td>è¯·æ±‚ä½“æ•°æ®ï¼ˆç”¨äº POST/PUT/PATCHï¼‰</td>
          </tr>
          <tr>
            <td><code>headers</code></td>
            <td>Object</td>
            <td>è‡ªå®šä¹‰è¯·æ±‚å¤´</td>
          </tr>
          <tr>
            <td><code>timeout</code></td>
            <td>Number</td>
            <td>è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œé»˜è®¤ 0ï¼ˆä¸è¶…æ—¶ï¼‰</td>
          </tr>
          <tr>
            <td><code>responseType</code></td>
            <td>String</td>
            <td>å“åº”ç±»å‹ï¼šjson/blob/text/arraybuffer</td>
          </tr>
        </tbody>
      </table>
    </KnowledgeCard>

    <!-- æ³¨æ„äº‹é¡¹ -->
    <TipBox type="warning" title="âš ï¸ æ³¨æ„äº‹é¡¹">
      <ul>
        <li><strong>GET è¯·æ±‚å‚æ•°</strong>ï¼šä½¿ç”¨ <code>params</code> è€Œä¸æ˜¯ <code>data</code></li>
        <li><strong>POST è¯·æ±‚æ•°æ®</strong>ï¼šé»˜è®¤ä¼šè½¬ä¸º JSON æ ¼å¼å‘é€</li>
        <li><strong>è·¨åŸŸé—®é¢˜</strong>ï¼šæµè§ˆå™¨ä¼šæœ‰åŒæºç­–ç•¥é™åˆ¶ï¼Œéœ€è¦æœåŠ¡ç«¯é…ç½® CORS</li>
        <li><strong>HTTPS</strong>ï¼šç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ HTTPS ä¿è¯å®‰å…¨</li>
      </ul>
    </TipBox>

    <!-- æœ€ä½³å®è·µ -->
    <TipBox type="success" title="âœ… æœ€ä½³å®è·µ">
      <ul>
        <li>ä½¿ç”¨ <code>axios.create()</code> åˆ›å»ºå®ä¾‹ï¼Œç»Ÿä¸€é…ç½® baseURL</li>
        <li>è®¾ç½®åˆç†çš„ <code>timeout</code> é¿å…è¯·æ±‚é•¿æ—¶é—´æŒ‚èµ·</li>
        <li>ä½¿ç”¨ async/await è¯­æ³•ï¼Œä»£ç æ›´ç®€æ´</li>
        <li>ç»Ÿä¸€å¤„ç†é”™è¯¯ï¼Œé¿å…æ¯ä¸ªè¯·æ±‚éƒ½å†™ try-catch</li>
      </ul>
    </TipBox>
  </div>
</template>

<script>
import KnowledgeCard from '@/components/content/KnowledgeCard.vue'
import TipBox from '@/components/content/TipBox.vue'
import CodeBlock from '@/components/demo/CodeBlock.vue'
import DemoBox from '@/components/demo/DemoBox.vue'
import scrollTrackingMixin from '@/utils/scrollTrackingMixin'

export default {
  name: 'AxiosBasic',
  mixins: [scrollTrackingMixin],
  components: {
    KnowledgeCard,
    TipBox,
    CodeBlock,
    DemoBox
  },
  data() {
    return {
      syntaxCode: `// 1. GET è¯·æ±‚
axios.get('/api/users', {
  params: { page: 1, limit: 10 }
})

// 2. POST è¯·æ±‚
axios.post('/api/users', {
  name: 'å¼ ä¸‰',
  email: 'zhangsan@example.com'
})

// 3. é€šç”¨é…ç½®æ–¹å¼
axios({
  method: 'post',
  url: '/api/users',
  data: { name: 'å¼ ä¸‰' },
  headers: { 'Content-Type': 'application/json' },
  timeout: 5000
})`
    }
  }
}
</script>

<style lang="scss" scoped>
@import '@/assets/styles/_variables.scss';
@import '@/assets/styles/_mixins.scss';

.knowledge-page {
  max-width: 900px;
}

.page-header {
  margin-bottom: $spacing-xl;

  .back-link {
    display: inline-block;
    margin-bottom: $spacing-md;
    color: $color-primary;
    text-decoration: none;
    font-size: $font-size-sm;

    &:hover {
      text-decoration: underline;
    }
  }

  h1 {
    margin: 0;
    font-size: $font-size-2xl;
  }
}

.concept-content {
  .analogy {
    padding: $spacing-md;
    background: rgba($color-primary, 0.05);
    border-radius: $radius-md;
    margin-bottom: $spacing-md;
  }

  .definition {
    color: $color-text-secondary;
  }
}

.feature-list {
  margin: $spacing-md 0;
  padding-left: $spacing-lg;

  li {
    margin-bottom: $spacing-sm;
    line-height: 1.6;
  }
}

.syntax-notes {
  margin-top: $spacing-md;
  padding: $spacing-md;
  background: $color-bg;
  border-radius: $radius-md;

  p {
    margin: $spacing-xs 0;
    font-size: $font-size-sm;
  }
}

.demo-desc {
  color: $color-text-secondary;
  margin-bottom: $spacing-md;
}

.config-table {
  width: 100%;
  border-collapse: collapse;
  font-size: $font-size-sm;

  th, td {
    padding: $spacing-sm $spacing-md;
    text-align: left;
    border-bottom: 1px solid $color-border;
  }

  th {
    background: $color-bg;
    font-weight: 600;
  }

  code {
    background: rgba($color-primary, 0.1);
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 13px;
  }
}
</style>

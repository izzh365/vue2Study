<template>
  <div class="knowledge-page">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="page-header">
      <h1>å¹¶å‘è¯·æ±‚</h1>
      <p class="subtitle">åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚å¹¶ç»Ÿä¸€å¤„ç†ç»“æœ</p>
    </div>

    <!-- æ¦‚å¿µè¯´æ˜ -->
    <KnowledgeCard title="ğŸ“– æ¦‚å¿µè¯´æ˜">
      <p><strong>å¹¶å‘è¯·æ±‚</strong>æ˜¯æŒ‡åŒæ—¶å‘é€å¤šä¸ª HTTP è¯·æ±‚ï¼Œç­‰å¾…æ‰€æœ‰è¯·æ±‚å®Œæˆåå†ç»Ÿä¸€å¤„ç†ç»“æœã€‚</p>
      
      <div class="analogy-box">
        <h4>ğŸ­ é€šä¿—æ¯”å–»</h4>
        <p>å°±åƒåœ¨é¤å…ç‚¹é¤ï¼š</p>
        <ul>
          <li><strong>é¡ºåºè¯·æ±‚</strong> = ç‚¹ä¸€é“èœ â†’ ç­‰ä¸Šèœ â†’ å†ç‚¹ä¸‹ä¸€é“ï¼ˆå¤ªæ…¢ï¼ï¼‰</li>
          <li><strong>å¹¶å‘è¯·æ±‚</strong> = ä¸€æ¬¡ç‚¹æ‰€æœ‰èœ â†’ æœåŠ¡å‘˜åŒæ—¶å»å‡†å¤‡ â†’ ä¸€èµ·ä¸Šæ¡Œï¼ˆæ›´å¿«ï¼ï¼‰</li>
        </ul>
      </div>
    </KnowledgeCard>

    <!-- å®ç°æ–¹å¼ -->
    <KnowledgeCard title="ğŸ”§ å®ç°æ–¹å¼">
      <table class="info-table">
        <thead>
          <tr>
            <th>æ–¹å¼</th>
            <th>è¯´æ˜</th>
            <th>æ¨è</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>Promise.all()</code></td>
            <td>åŸç”Ÿ JS æ–¹æ³•ï¼Œæ‰€æœ‰æˆåŠŸæ‰æˆåŠŸ</td>
            <td>â­â­â­ æ¨è</td>
          </tr>
          <tr>
            <td><code>Promise.allSettled()</code></td>
            <td>ç­‰å¾…æ‰€æœ‰å®Œæˆï¼ˆæ— è®ºæˆåŠŸå¤±è´¥ï¼‰</td>
            <td>â­â­â­ æ¨è</td>
          </tr>
          <tr>
            <td><code>axios.all()</code></td>
            <td>Axios å°è£…çš„å¹¶å‘æ–¹æ³•ï¼ˆå·²åºŸå¼ƒï¼‰</td>
            <td>â­ ä¸æ¨è</td>
          </tr>
          <tr>
            <td><code>Promise.race()</code></td>
            <td>è¿”å›æœ€å…ˆå®Œæˆçš„è¯·æ±‚ç»“æœ</td>
            <td>â­â­ ç‰¹æ®Šåœºæ™¯</td>
          </tr>
        </tbody>
      </table>
    </KnowledgeCard>

    <!-- Demo 1: Promise.all åŸºç¡€ -->
    <KnowledgeCard title="ğŸ¯ Demo 1: Promise.all åŸºç¡€">
      <p>åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚ï¼Œå…¨éƒ¨æˆåŠŸåè¿”å›ç»“æœï¼š</p>
      <DemoBox 
        demoPath="axios/promise-all-basic"
        title="Promise.all å¹¶å‘è¯·æ±‚"
        height="400px"
      />
    </KnowledgeCard>

    <!-- è¯­æ³•è¯´æ˜ -->
    <KnowledgeCard title="ğŸ“ Promise.all è¯­æ³•">
      <CodeBlock :code="promiseAllCode" language="javascript" />
      
      <TipBox type="warning" title="âš ï¸ æ³¨æ„">
        <p>Promise.all çš„ç‰¹ç‚¹æ˜¯"å…¨æœ‰æˆ–å…¨æ— "ï¼šåªè¦æœ‰ä¸€ä¸ªè¯·æ±‚å¤±è´¥ï¼Œæ•´ä½“å°±ä¼šè¿›å…¥ catchã€‚</p>
      </TipBox>
    </KnowledgeCard>

    <!-- Demo 2: Promise.allSettled -->
    <KnowledgeCard title="ğŸ¯ Demo 2: Promise.allSettled">
      <p>æ— è®ºæˆåŠŸå¤±è´¥éƒ½è¿”å›ç»“æœï¼Œé€‚åˆéœ€è¦å®¹é”™çš„åœºæ™¯ï¼š</p>
      <DemoBox 
        demoPath="axios/promise-all-settled"
        title="Promise.allSettled å®¹é”™å¤„ç†"
        height="420px"
      />
    </KnowledgeCard>

    <!-- Demo 3: Promise.race -->
    <KnowledgeCard title="ğŸ¯ Demo 3: Promise.race">
      <p>åªè¿”å›æœ€å…ˆå®Œæˆçš„è¯·æ±‚ç»“æœï¼š</p>
      <DemoBox 
        demoPath="axios/promise-race"
        title="Promise.race ç«é€Ÿè¯·æ±‚"
        height="380px"
      />
    </KnowledgeCard>

    <!-- Demo 4: å®æˆ˜æ¡ˆä¾‹ -->
    <KnowledgeCard title="ğŸ¯ Demo 4: å®æˆ˜æ¡ˆä¾‹ - ä»ªè¡¨ç›˜æ•°æ®åŠ è½½">
      <p>å…¸å‹åº”ç”¨åœºæ™¯ï¼šé¡µé¢åˆå§‹åŒ–æ—¶åŒæ—¶åŠ è½½å¤šä¸ªæ¥å£æ•°æ®</p>
      <DemoBox 
        demoPath="axios/concurrent-dashboard"
        title="ä»ªè¡¨ç›˜æ•°æ®å¹¶å‘åŠ è½½"
        height="450px"
      />
    </KnowledgeCard>

    <!-- Demo 5: æ‰¹é‡è¯·æ±‚ -->
    <KnowledgeCard title="ğŸ¯ Demo 5: æ‰¹é‡è¯·æ±‚ä¸é™æµ">
      <p>å¤„ç†å¤§é‡è¯·æ±‚æ—¶çš„åˆ†æ‰¹ç­–ç•¥ï¼š</p>
      <DemoBox 
        demoPath="axios/batch-requests"
        title="æ‰¹é‡è¯·æ±‚é™æµ"
        height="400px"
      />
    </KnowledgeCard>

    <!-- å¯¹æ¯”è¡¨æ ¼ -->
    <KnowledgeCard title="ğŸ“Š æ–¹æ³•å¯¹æ¯”">
      <table class="info-table">
        <thead>
          <tr>
            <th>ç‰¹æ€§</th>
            <th>Promise.all</th>
            <th>Promise.allSettled</th>
            <th>Promise.race</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>ç­‰å¾…æ‰€æœ‰å®Œæˆ</td>
            <td>âœ… æ˜¯</td>
            <td>âœ… æ˜¯</td>
            <td>âŒ å¦</td>
          </tr>
          <tr>
            <td>ä¸€ä¸ªå¤±è´¥çš„å½±å“</td>
            <td>æ•´ä½“å¤±è´¥</td>
            <td>ä¸å½±å“å…¶ä»–</td>
            <td>å¦‚æœæœ€å¿«çš„å¤±è´¥åˆ™å¤±è´¥</td>
          </tr>
          <tr>
            <td>è¿”å›æ ¼å¼</td>
            <td>ç»“æœæ•°ç»„</td>
            <td>{ status, value/reason }</td>
            <td>å•ä¸ªç»“æœ</td>
          </tr>
          <tr>
            <td>é€‚ç”¨åœºæ™¯</td>
            <td>æ‰€æœ‰æ•°æ®éƒ½å¿…éœ€</td>
            <td>éƒ¨åˆ†å¤±è´¥å¯æ¥å—</td>
            <td>æœ€å¿«å“åº”ä¼˜å…ˆ</td>
          </tr>
        </tbody>
      </table>
    </KnowledgeCard>

    <!-- æœ€ä½³å®è·µ -->
    <TipBox type="success" title="âœ… æœ€ä½³å®è·µ">
      <ol>
        <li><strong>ä¼˜å…ˆä½¿ç”¨ Promise.all</strong>ï¼šè¯­æ³•ç®€æ´ï¼Œæ€§èƒ½å¥½</li>
        <li><strong>éœ€è¦å®¹é”™ç”¨ allSettled</strong>ï¼šéƒ¨åˆ†å¤±è´¥ä¸å½±å“æ•´ä½“</li>
        <li><strong>æ·»åŠ  loading çŠ¶æ€</strong>ï¼šå‘ŠçŸ¥ç”¨æˆ·æ­£åœ¨åŠ è½½</li>
        <li><strong>æ‰¹é‡è¯·æ±‚æ³¨æ„é™æµ</strong>ï¼šé¿å…åŒæ—¶å‘é€è¿‡å¤šè¯·æ±‚</li>
        <li><strong>åˆç†è®¾ç½®è¶…æ—¶</strong>ï¼šé˜²æ­¢å•ä¸ªè¯·æ±‚é˜»å¡æ•´ä½“</li>
      </ol>
    </TipBox>
  </div>
</template>

<script>
import KnowledgeCard from '@/components/content/KnowledgeCard.vue'
import TipBox from '@/components/content/TipBox.vue'
import CodeBlock from '@/components/demo/CodeBlock.vue'
import DemoBox from '@/components/demo/DemoBox.vue'

export default {
  name: 'AxiosConcurrent',
  
  components: {
    KnowledgeCard,
    TipBox,
    CodeBlock,
    DemoBox
  },
  
  data() {
    return {
      promiseAllCode: `// Promise.all å¹¶å‘è¯·æ±‚
async function fetchAllData() {
  try {
    // åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚
    const [users, posts, comments] = await Promise.all([
      axios.get('/api/users'),
      axios.get('/api/posts'),
      axios.get('/api/comments')
    ])
    
    // æ‰€æœ‰è¯·æ±‚éƒ½æˆåŠŸåæ‰§è¡Œ
    console.log('ç”¨æˆ·:', users.data)
    console.log('æ–‡ç« :', posts.data)
    console.log('è¯„è®º:', comments.data)
    
  } catch (error) {
    // ä»»ä¸€è¯·æ±‚å¤±è´¥éƒ½ä¼šè¿›å…¥è¿™é‡Œ
    console.error('è¯·æ±‚å¤±è´¥:', error)
  }
}`
    }
  }
}
</script>

<style lang="scss" scoped>
.knowledge-page {
  max-width: 900px;
  margin: 0 auto;
  padding: 20px;
}

.page-header {
  text-align: center;
  margin-bottom: 32px;
  
  h1 {
    font-size: 28px;
    color: #1d1d1f;
    margin-bottom: 8px;
  }
  
  .subtitle {
    color: #86868b;
    font-size: 16px;
  }
}

.analogy-box {
  background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
  padding: 16px;
  border-radius: 8px;
  margin-top: 16px;
  
  h4 {
    margin-bottom: 8px;
    color: #1e40af;
  }
  
  p, ul {
    color: #1e3a8a;
    font-size: 14px;
  }
  
  ul {
    padding-left: 20px;
    margin-top: 8px;
  }
}

.info-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 12px;
  
  th, td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid #e5e5ea;
  }
  
  th {
    background: #f5f5f7;
    font-weight: 600;
    color: #1d1d1f;
  }
  
  code {
    background: #e8e8ed;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 13px;
  }
}
</style>

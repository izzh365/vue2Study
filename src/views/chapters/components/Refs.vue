<template>
  <div class="refs-page">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="page-header">
      <h1>ğŸ”— $refs è®¿é—®å­ç»„ä»¶</h1>
      <p class="subtitle">Refs - ç›´æ¥è®¿é—® DOM å…ƒç´ æˆ–å­ç»„ä»¶å®ä¾‹</p>
    </div>

    <!-- æ¦‚å¿µè¯´æ˜ -->
    <KnowledgeCard title="ğŸ“– ä»€ä¹ˆæ˜¯ $refsï¼Ÿ">
      <div class="concept-content">
        <div class="analogy">
          <span class="emoji">ğŸ·ï¸</span>
          <div>
            <strong>é€šä¿—æ¯”å–»ï¼š</strong>
            <code>ref</code> å°±åƒç»™å…ƒç´ è´´<strong>æ ‡ç­¾</strong>â€”â€”é€šè¿‡è¿™ä¸ªæ ‡ç­¾å¯ä»¥ç›´æ¥æ‰¾åˆ°å®ƒï¼
            ç±»ä¼¼äºèº«ä»½è¯å·ï¼Œæœ‰äº†å®ƒå°±èƒ½ç²¾ç¡®å®šä½ã€‚
          </div>
        </div>
        <p class="definition">
          <strong>å®˜æ–¹å®šä¹‰ï¼š</strong>
          <code>ref</code> ç”¨äºç»™å…ƒç´ æˆ–å­ç»„ä»¶æ³¨å†Œå¼•ç”¨ä¿¡æ¯ã€‚
          å¼•ç”¨ä¿¡æ¯å°†è¢«æ³¨å†Œåˆ°çˆ¶ç»„ä»¶çš„ <code>$refs</code> å¯¹è±¡ä¸Šã€‚
        </p>
      </div>
    </KnowledgeCard>

    <!-- ä½¿ç”¨åœºæ™¯ -->
    <KnowledgeCard title="ğŸ’¡ $refs ä½¿ç”¨åœºæ™¯">
      <ul class="scene-list">
        <li>
          <span class="icon">ğŸ“</span>
          <div>
            <strong>æ“ä½œ DOM å…ƒç´ </strong>
            <p>è·å–è¾“å…¥æ¡†ç„¦ç‚¹ã€æ“ä½œ Canvasã€æµ‹é‡å…ƒç´ å°ºå¯¸</p>
          </div>
        </li>
        <li>
          <span class="icon">ğŸ®</span>
          <div>
            <strong>è°ƒç”¨å­ç»„ä»¶æ–¹æ³•</strong>
            <p>å¦‚è°ƒç”¨è§†é¢‘ç»„ä»¶çš„ play()ã€è¡¨å•ç»„ä»¶çš„ validate()</p>
          </div>
        </li>
        <li>
          <span class="icon">ğŸ“Š</span>
          <div>
            <strong>è®¿é—®å­ç»„ä»¶æ•°æ®</strong>
            <p>åœ¨æŸäº›åœºæ™¯ä¸‹éœ€è¦è¯»å–å­ç»„ä»¶çš„çŠ¶æ€</p>
          </div>
        </li>
      </ul>
    </KnowledgeCard>

    <!-- Demo 1: è®¿é—® DOM -->
    <KnowledgeCard title="ğŸ¯ Demo 1ï¼šè®¿é—® DOM å…ƒç´ ">
      <TipBox type="info">
        <p>å½“ <code>ref</code> ç”¨åœ¨æ™®é€š DOM å…ƒç´ ä¸Šæ—¶ï¼Œ<code>this.$refs.xxx</code> è·å–çš„æ˜¯ DOM å…ƒç´ æœ¬èº«ã€‚</p>
      </TipBox>
      <DemoBox demoPath="components/refs-dom" title="è®¿é—® DOM å…ƒç´ " />
    </KnowledgeCard>

    <!-- Demo 2: è®¿é—®å­ç»„ä»¶ -->
    <KnowledgeCard title="ğŸ¯ Demo 2ï¼šè®¿é—®å­ç»„ä»¶å®ä¾‹">
      <TipBox type="info">
        <p>å½“ <code>ref</code> ç”¨åœ¨å­ç»„ä»¶ä¸Šæ—¶ï¼Œ<code>this.$refs.xxx</code> è·å–çš„æ˜¯ç»„ä»¶å®ä¾‹ï¼Œå¯ä»¥è°ƒç”¨å…¶æ–¹æ³•å’Œè®¿é—®å…¶æ•°æ®ã€‚</p>
      </TipBox>
      <DemoBox demoPath="components/refs-component" title="è®¿é—®å­ç»„ä»¶å®ä¾‹" />
    </KnowledgeCard>

    <!-- Demo 3: $parent å’Œ $children -->
    <KnowledgeCard title="ğŸ¯ Demo 3ï¼š$parent å’Œ $children">
      <TipBox type="warning">
        <p><code>$parent</code> å’Œ <code>$children</code> å¯ä»¥è®¿é—®çˆ¶/å­ç»„ä»¶ï¼Œä½†ä¼šé€ æˆ<strong>å¼ºè€¦åˆ</strong>ï¼Œåº”è°¨æ…ä½¿ç”¨ï¼</p>
      </TipBox>
      <div class="compare-table">
        <table>
          <thead>
            <tr>
              <th>å±æ€§</th>
              <th>è¯´æ˜</th>
              <th>æ³¨æ„äº‹é¡¹</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>$parent</code></td>
              <td>è®¿é—®çˆ¶ç»„ä»¶å®ä¾‹</td>
              <td>åµŒå¥—å±‚çº§å˜åŒ–æ—¶ä¼šå‡ºé—®é¢˜</td>
            </tr>
            <tr>
              <td><code>$children</code></td>
              <td>è®¿é—®å­ç»„ä»¶æ•°ç»„</td>
              <td>é¡ºåºä¸ç¡®å®šï¼ŒVue 3 å·²ç§»é™¤</td>
            </tr>
            <tr>
              <td><code>$root</code></td>
              <td>è®¿é—®æ ¹ç»„ä»¶å®ä¾‹</td>
              <td>ä¸æ¨èç”¨äºç»„ä»¶é€šä¿¡</td>
            </tr>
          </tbody>
        </table>
      </div>
      <DemoBox demoPath="components/refs-parent-children" title="$parent å’Œ $children" />
    </KnowledgeCard>

    <!-- æ³¨æ„äº‹é¡¹ -->
    <TipBox type="warning" title="âš ï¸ æ³¨æ„äº‹é¡¹">
      <ul class="warning-list">
        <li><code>$refs</code> åªåœ¨ç»„ä»¶æ¸²æŸ“å®Œæˆåæ‰å¡«å……ï¼Œåœ¨ <code>mounted</code> ä¹‹åæ‰èƒ½è®¿é—®</li>
        <li><code>$refs</code> ä¸æ˜¯å“åº”å¼çš„ï¼Œä¸è¦åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨</li>
        <li>é¿å…åœ¨å­ç»„ä»¶å†…éƒ¨é€šè¿‡ <code>$refs</code> è®¿é—®ï¼Œè¿™ä¼šç ´åç»„ä»¶å°è£…</li>
        <li><code>$parent</code>/<code>$children</code> ä¼šå¯¼è‡´ç»„ä»¶è€¦åˆï¼Œä¼˜å…ˆä½¿ç”¨ props å’Œ $emit</li>
      </ul>
    </TipBox>

    <!-- æœ€ä½³å®è·µ -->
    <TipBox type="success" title="âœ… æœ€ä½³å®è·µ">
      <ul class="practice-list">
        <li>ä»…åœ¨éœ€è¦<strong>ç›´æ¥æ“ä½œ DOM</strong> æ—¶ä½¿ç”¨ $refs</li>
        <li>å­ç»„ä»¶åº”è¯¥æš´éœ²<strong>æ¸…æ™°çš„æ–¹æ³•æ¥å£</strong>ï¼Œè€Œä¸æ˜¯è®©çˆ¶ç»„ä»¶ç›´æ¥è®¿é—®å†…éƒ¨æ•°æ®</li>
        <li>ä½¿ç”¨ <code>props</code> å’Œ <code>$emit</code> ä½œä¸ºä¸»è¦é€šä¿¡æ–¹å¼</li>
        <li>å¤æ‚åœºæ™¯è€ƒè™‘ä½¿ç”¨ <strong>Vuex</strong> è¿›è¡ŒçŠ¶æ€ç®¡ç†</li>
      </ul>
    </TipBox>
  </div>
</template>

<script>
import KnowledgeCard from '@/components/content/KnowledgeCard.vue'
import TipBox from '@/components/content/TipBox.vue'
import DemoBox from '@/components/demo/DemoBox.vue'
import scrollTrackingMixin from '@/utils/scrollTrackingMixin'

export default {
  name: 'RefsPage',

  mixins: [scrollTrackingMixin],

  components: {
    KnowledgeCard,
    TipBox,
    DemoBox
  }
}
</script>

<style lang="scss" scoped>
.refs-page {
  padding: 0 0 $spacing-2xl;
}

.page-header {
  text-align: center;
  margin-bottom: $spacing-xl;
  padding: $spacing-xl;
  background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
  border-radius: $radius-lg;
  color: white;

  h1 {
    font-size: 28px;
    margin-bottom: $spacing-sm;
  }

  .subtitle {
    opacity: 0.9;
    font-size: $font-size-lg;
  }
}

.concept-content {
  .analogy {
    display: flex;
    gap: $spacing-md;
    padding: $spacing-md;
    background: $color-bg;
    border-radius: $radius-md;
    margin-bottom: $spacing-md;

    .emoji {
      font-size: 32px;
    }
  }

  .definition {
    color: $color-text-secondary;
    line-height: 1.8;

    strong {
      color: $color-text;
    }

    code {
      background: $color-code-bg;
      padding: 2px 6px;
      border-radius: $radius-sm;
      font-family: $font-family-code;
    }
  }
}

.scene-list {
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: $spacing-md;

  li {
    display: flex;
    gap: $spacing-md;
    padding: $spacing-md;
    background: $color-bg;
    border-radius: $radius-md;

    .icon {
      font-size: 24px;
    }

    strong {
      display: block;
      color: $color-text;
      margin-bottom: 4px;
    }

    p {
      color: $color-text-secondary;
      font-size: $font-size-sm;
      margin: 0;
    }
  }
}

.compare-table {
  margin-bottom: $spacing-md;
  overflow-x: auto;

  table {
    width: 100%;
    border-collapse: collapse;
    font-size: $font-size-sm;

    th, td {
      padding: $spacing-sm $spacing-md;
      text-align: left;
      border-bottom: 1px solid $color-border;
    }

    th {
      background: $color-bg;
      font-weight: 600;
    }

    code {
      background: $color-code-bg;
      padding: 2px 6px;
      border-radius: $radius-sm;
      font-family: $font-family-code;
    }
  }
}

.warning-list, .practice-list {
  margin: 0;
  padding-left: $spacing-lg;

  li {
    margin-bottom: $spacing-sm;
    line-height: 1.6;

    &:last-child {
      margin-bottom: 0;
    }

    code {
      background: rgba(0,0,0,0.05);
      padding: 2px 6px;
      border-radius: $radius-sm;
      font-family: $font-family-code;
    }
  }
}
</style>

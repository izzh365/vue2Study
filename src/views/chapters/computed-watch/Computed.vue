<template>
  <div class="knowledge-page computed-page">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="page-header">
      <h1>ğŸ§® computed è®¡ç®—å±æ€§</h1>
      <p class="page-desc">åŸºäºç°æœ‰æ•°æ®è‡ªåŠ¨è®¡ç®—æ–°æ•°æ®ï¼Œè‡ªå¸¦ç¼“å­˜æœºåˆ¶</p>
    </div>

    <!-- æ¦‚å¿µè¯´æ˜ -->
    <KnowledgeCard title="ğŸ“– ä»€ä¹ˆæ˜¯è®¡ç®—å±æ€§ï¼Ÿ">
      <p>
        <strong>computed</strong>ï¼ˆè®¡ç®—å±æ€§ï¼‰æ˜¯ Vue ä¸­ç”¨äºå£°æ˜"æ´¾ç”Ÿæ•°æ®"çš„æ–¹å¼ã€‚
        å®ƒä¼šæ ¹æ®ä¾èµ–çš„æ•°æ®è‡ªåŠ¨è®¡ç®—å¹¶ç¼“å­˜ç»“æœï¼Œåªæœ‰ä¾èµ–å˜åŒ–æ—¶æ‰é‡æ–°è®¡ç®—ã€‚
      </p>
      <div class="analogy-box">
        <span class="analogy-icon">ğŸ“Š</span>
        <div>
          <strong>é€šä¿—æ¯”å–»ï¼š</strong>å°±åƒ Excel çš„å…¬å¼å•å…ƒæ ¼ï¼ŒC1 = A1 + B1ã€‚
          åªè¦ A1 æˆ– B1 å˜åŒ–ï¼ŒC1 è‡ªåŠ¨æ›´æ–°ã€‚ä¸å˜å°±ç›´æ¥ç”¨ç¼“å­˜ç»“æœã€‚
        </div>
      </div>
    </KnowledgeCard>

    <!-- computed vs methods -->
    <KnowledgeCard title="ğŸ’¡ computed vs methods çš„åŒºåˆ«">
      <div class="compare-table">
        <div class="compare-header">
          <div class="compare-col">å¯¹æ¯”é¡¹</div>
          <div class="compare-col highlight">computed è®¡ç®—å±æ€§</div>
          <div class="compare-col">methods æ–¹æ³•</div>
        </div>
        <div class="compare-row">
          <div class="compare-col">ç¼“å­˜</div>
          <div class="compare-col highlight">âœ… æœ‰ç¼“å­˜</div>
          <div class="compare-col">âŒ æ— ç¼“å­˜</div>
        </div>
        <div class="compare-row">
          <div class="compare-col">è°ƒç”¨æ–¹å¼</div>
          <div class="compare-col highlight">å½“å±æ€§ä½¿ç”¨ï¼ˆä¸åŠ æ‹¬å·ï¼‰</div>
          <div class="compare-col">å½“å‡½æ•°è°ƒç”¨ï¼ˆåŠ æ‹¬å·ï¼‰</div>
        </div>
        <div class="compare-row">
          <div class="compare-col">é‡æ–°è®¡ç®—</div>
          <div class="compare-col highlight">ä¾èµ–å˜åŒ–æ—¶</div>
          <div class="compare-col">æ¯æ¬¡æ¸²æŸ“æ—¶</div>
        </div>
        <div class="compare-row">
          <div class="compare-col">æ€§èƒ½</div>
          <div class="compare-col highlight">æ›´å¥½</div>
          <div class="compare-col">ä¸€èˆ¬</div>
        </div>
      </div>
    </KnowledgeCard>

    <!-- è¯­æ³•æ ¼å¼ -->
    <KnowledgeCard title="ğŸ“ è¯­æ³•æ ¼å¼">
      <CodeBlock 
        :code="syntaxCode"
        language="javascript"
      />
      <TipBox type="info" title="ä½¿ç”¨æ–¹å¼">
        <p>è®¡ç®—å±æ€§åƒæ™®é€šå±æ€§ä¸€æ ·åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ï¼š<code v-pre>{{ fullName }}</code>ï¼Œä¸éœ€è¦åŠ æ‹¬å·ï¼</p>
      </TipBox>
    </KnowledgeCard>

    <!-- Demo å±•ç¤ºåŒº -->
    <KnowledgeCard title="ğŸ¯ å®æˆ˜ç¤ºä¾‹">
      <!-- Demo 1: åŸºç¡€ç”¨æ³• -->
      <div class="demo-section">
        <h4>Demo 1: è®¡ç®—å±æ€§åŸºç¡€</h4>
        <p class="demo-desc">æœ€å¸¸è§çš„åœºæ™¯ï¼šæ‹¼æ¥å…¨å</p>
        <DemoBox 
          demoPath="computed-watch/computed-basic"
          title="computed åŸºæœ¬ç”¨æ³•"
          height="520px"
        />
      </div>

      <!-- Demo 2: ç¼“å­˜ç‰¹æ€§ -->
      <div class="demo-section">
        <h4>Demo 2: ç¼“å­˜ç‰¹æ€§å¯¹æ¯”</h4>
        <p class="demo-desc">å¯¹æ¯” computed å’Œ methods çš„æ‰§è¡Œæ¬¡æ•°å·®å¼‚</p>
        <DemoBox 
          demoPath="computed-watch/computed-cache"
          title="computed ç¼“å­˜æœºåˆ¶"
          height="680px"
        />
      </div>

      <!-- Demo 3: getter/setter -->
      <div class="demo-section">
        <h4>Demo 3: getter å’Œ setter</h4>
        <p class="demo-desc">è®¡ç®—å±æ€§ä¹Ÿå¯ä»¥åŒå‘ç»‘å®šï¼Œé€šè¿‡ set å®ç°</p>
        <DemoBox 
          demoPath="computed-watch/computed-setter"
          title="computed getter/setter"
          height="550px"
        />
      </div>

      <!-- Demo 4: è¿‡æ»¤åˆ—è¡¨ -->
      <div class="demo-section">
        <h4>Demo 4: è¿‡æ»¤åˆ—è¡¨</h4>
        <p class="demo-desc">å®ç°æœç´¢ç­›é€‰åŠŸèƒ½</p>
        <DemoBox 
          demoPath="computed-watch/computed-filter"
          title="computed è¿‡æ»¤åˆ—è¡¨"
          height="580px"
        />
      </div>

      <!-- Demo 5: æ’åºåˆ—è¡¨ -->
      <div class="demo-section">
        <h4>Demo 5: æ’åºåˆ—è¡¨</h4>
        <p class="demo-desc">å¤šç§æ’åºæ–¹å¼åˆ‡æ¢</p>
        <DemoBox 
          demoPath="computed-watch/computed-sort"
          title="computed æ’åºåˆ—è¡¨"
          height="580px"
        />
      </div>

      <!-- Demo 6: åŠ¨æ€æ ·å¼ -->
      <div class="demo-section">
        <h4>Demo 6: è®¡ç®—åŠ¨æ€æ ·å¼</h4>
        <p class="demo-desc">å¤šä¸ªæ•°æ®ç»„åˆæˆå¤æ‚æ ·å¼å¯¹è±¡</p>
        <DemoBox 
          demoPath="computed-watch/computed-style"
          title="computed åŠ¨æ€æ ·å¼"
          height="750px"
        />
      </div>
    </KnowledgeCard>

    <!-- æœ€ä½³å®è·µ -->
    <KnowledgeCard title="âœ¨ æœ€ä½³å®è·µ">
      <div class="practice-list">
        <div class="practice-item good">
          <span class="practice-icon">âœ…</span>
          <div>
            <strong>ç”¨äºæ¨¡æ¿ä¸­éœ€è¦å¤æ‚è®¡ç®—çš„åœºæ™¯</strong>
            <p>é¿å…åœ¨æ¨¡æ¿ä¸­å†™å¤æ‚è¡¨è¾¾å¼ï¼Œç”¨ computed å°è£…</p>
          </div>
        </div>
        <div class="practice-item good">
          <span class="practice-icon">âœ…</span>
          <div>
            <strong>åˆ—è¡¨è¿‡æ»¤ã€æ’åºä¼˜å…ˆä½¿ç”¨ computed</strong>
            <p>æ¯”åœ¨ v-for ä¸­è°ƒç”¨ methods æ€§èƒ½æ›´å¥½</p>
          </div>
        </div>
        <div class="practice-item good">
          <span class="practice-icon">âœ…</span>
          <div>
            <strong>computed åªåšè®¡ç®—ï¼Œä¸åšå‰¯ä½œç”¨æ“ä½œ</strong>
            <p>å¦‚éœ€å¼‚æ­¥è¯·æ±‚æˆ–ä¿®æ”¹å…¶ä»–æ•°æ®ï¼Œè¯·ç”¨ watch</p>
          </div>
        </div>
        <div class="practice-item bad">
          <span class="practice-icon">âŒ</span>
          <div>
            <strong>ä¸è¦åœ¨ computed ä¸­ä¿®æ”¹ä¾èµ–çš„æ•°æ®</strong>
            <p>å¯èƒ½å¯¼è‡´æ— é™å¾ªç¯</p>
          </div>
        </div>
      </div>
    </KnowledgeCard>

    <!-- å¸¸è§é”™è¯¯ -->
    <TipBox type="error" title="âŒ å¸¸è§é”™è¯¯">
      <div class="error-item">
        <p><strong>é”™è¯¯ï¼š</strong>åœ¨æ¨¡æ¿ä¸­è°ƒç”¨è®¡ç®—å±æ€§æ—¶åŠ æ‹¬å·</p>
        <code class="error-code" v-pre>{{ fullName() }}</code>
        <p><strong>æ­£ç¡®ï¼š</strong>åƒå±æ€§ä¸€æ ·ä½¿ç”¨ï¼Œä¸åŠ æ‹¬å·</p>
        <code class="correct-code" v-pre>{{ fullName }}</code>
      </div>
    </TipBox>
  </div>
</template>

<script>
/**
 * Computed è®¡ç®—å±æ€§é¡µé¢
 * 
 * @description è¯¦ç»†è®²è§£ Vue è®¡ç®—å±æ€§çš„æ¦‚å¿µã€ç”¨æ³•å’Œæœ€ä½³å®è·µ
 */
import KnowledgeCard from '@/components/content/KnowledgeCard.vue'
import TipBox from '@/components/content/TipBox.vue'
import CodeBlock from '@/components/demo/CodeBlock.vue'
import DemoBox from '@/components/demo/DemoBox.vue'

export default {
  name: 'ComputedPage',
  
  components: {
    KnowledgeCard,
    TipBox,
    CodeBlock,
    DemoBox
  },
  
  data() {
    return {
      // è¯­æ³•ç¤ºä¾‹ä»£ç 
      syntaxCode: `export default {
  data() {
    return {
      firstName: 'å¼ ',
      lastName: 'ä¸‰'
    }
  },
  
  computed: {
    // ç®€å†™ï¼šåªæœ‰ getter
    fullName() {
      return this.firstName + this.lastName
    },
    
    // å®Œæ•´å†™æ³•ï¼šgetter + setter
    fullNameWithSetter: {
      get() {
        return this.firstName + this.lastName
      },
      set(newValue) {
        // æ‹†åˆ†å…¨å
        const names = newValue.split(' ')
        this.firstName = names[0]
        this.lastName = names[1] || ''
      }
    }
  }
}`
    }
  }
}
</script>

<style lang="scss" scoped>
.computed-page {
  .page-header {
    margin-bottom: $spacing-xl;
    
    h1 {
      font-size: $font-size-3xl;
      color: $color-text;
      margin-bottom: $spacing-sm;
    }
    
    .page-desc {
      font-size: $font-size-lg;
      color: $color-text-secondary;
    }
  }
  
  .analogy-box {
    display: flex;
    align-items: flex-start;
    gap: $spacing-md;
    padding: $spacing-md;
    background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
    border-radius: $radius-md;
    margin-top: $spacing-md;
    
    .analogy-icon {
      font-size: 28px;
    }
  }
  
  // å¯¹æ¯”è¡¨æ ¼
  .compare-table {
    border: 1px solid $color-border;
    border-radius: $radius-md;
    overflow: hidden;
    
    .compare-header,
    .compare-row {
      display: grid;
      grid-template-columns: 1fr 1.5fr 1.5fr;
      
      .compare-col {
        padding: $spacing-md;
        border-right: 1px solid $color-border;
        
        &:last-child {
          border-right: none;
        }
        
        &.highlight {
          background: #e8f5e9;
        }
      }
    }
    
    .compare-header {
      background: $color-code-bg;
      font-weight: 600;
      
      .compare-col.highlight {
        background: #c8e6c9;
      }
    }
    
    .compare-row {
      border-top: 1px solid $color-border;
    }
  }
  
  .demo-section {
    margin-bottom: $spacing-xl;
    
    &:last-child {
      margin-bottom: 0;
    }
    
    h4 {
      font-size: $font-size-lg;
      color: $color-text;
      margin-bottom: $spacing-sm;
    }
    
    .demo-desc {
      color: $color-text-secondary;
      margin-bottom: $spacing-md;
    }
  }
  
  // æœ€ä½³å®è·µåˆ—è¡¨
  .practice-list {
    display: flex;
    flex-direction: column;
    gap: $spacing-md;
    
    .practice-item {
      display: flex;
      align-items: flex-start;
      gap: $spacing-md;
      padding: $spacing-md;
      border-radius: $radius-md;
      
      &.good {
        background: #e8f5e9;
      }
      
      &.bad {
        background: #ffebee;
      }
      
      .practice-icon {
        font-size: 20px;
        flex-shrink: 0;
      }
      
      strong {
        display: block;
        margin-bottom: 4px;
        color: $color-text;
      }
      
      p {
        font-size: $font-size-sm;
        color: $color-text-secondary;
        margin: 0;
      }
    }
  }
  
  // é”™è¯¯ç¤ºä¾‹
  .error-item {
    .error-code {
      display: block;
      padding: $spacing-sm $spacing-md;
      background: #ffcdd2;
      border-radius: $radius-sm;
      margin: $spacing-sm 0;
      color: #c62828;
    }
    
    .correct-code {
      display: block;
      padding: $spacing-sm $spacing-md;
      background: #c8e6c9;
      border-radius: $radius-sm;
      margin: $spacing-sm 0;
      color: #2e7d32;
    }
  }
}
</style>

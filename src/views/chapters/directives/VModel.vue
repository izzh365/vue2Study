<template>
  <div class="directive-page v-model-page">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="page-header">
      <h1>ğŸ”„ v-model åŒå‘ç»‘å®š</h1>
      <p class="page-desc">è¡¨å•è¾“å…¥ä¸æ•°æ®çš„åŒå‘åŒæ­¥</p>
    </div>

    <!-- æ¦‚å¿µè¯´æ˜ -->
    <KnowledgeCard title="ğŸ“– ä»€ä¹ˆæ˜¯åŒå‘ç»‘å®šï¼Ÿ">
      <p>
        <strong>åŒå‘ç»‘å®š</strong> = æ•°æ®å˜åŒ– â†’ è§†å›¾æ›´æ–° + è§†å›¾å˜åŒ– â†’ æ•°æ®æ›´æ–°
      </p>
      <div class="flow-diagram">
        <div class="flow-box">ğŸ“Š data æ•°æ®</div>
        <div class="flow-arrow">âŸ·</div>
        <div class="flow-box">ğŸ“ è¡¨å•è¾“å…¥</div>
      </div>
      <div class="analogy-box">
        <span class="analogy-icon">ğŸª</span>
        <div>
          <strong>é€šä¿—æ¯”å–»ï¼š</strong>å°±åƒé•œå­ä¸€æ ·ï¼Œæ•°æ®å’Œè§†å›¾äº’ä¸ºé•œåƒï¼Œä¸€æ–¹å˜åŒ–ï¼Œå¦ä¸€æ–¹ç«‹å³åŒæ­¥
        </div>
      </div>
    </KnowledgeCard>

    <!-- æœ¬è´¨è§£æ -->
    <KnowledgeCard title="ğŸ”§ v-model çš„æœ¬è´¨">
      <p>v-model å…¶å®æ˜¯è¯­æ³•ç³–ï¼Œæœ¬è´¨æ˜¯ v-bind + v-on çš„ç»„åˆï¼š</p>
      <CodeBlock 
        :code="essenceCode"
        language="html"
      />
    </KnowledgeCard>

    <!-- Demo å±•ç¤ºåŒº -->
    <KnowledgeCard title="ğŸ¯ å®æˆ˜ç¤ºä¾‹">
      <!-- Demo 1: åŸºç¡€ç”¨æ³• -->
      <div class="demo-section">
        <h4>Demo 1: æ–‡æœ¬è¾“å…¥æ¡†</h4>
        <p class="demo-desc">æœ€åŸºç¡€çš„åŒå‘ç»‘å®šæ¼”ç¤º</p>
        <DemoBox 
          demoPath="directives/v-model-basic"
          title="v-model åŸºç¡€ç”¨æ³•"
          height="650px"
        />
      </div>

      <!-- Demo 2: å¤é€‰æ¡†å’Œå•é€‰æ¡† -->
      <div class="demo-section">
        <h4>Demo 2: å¤é€‰æ¡†å’Œå•é€‰æ¡†</h4>
        <p class="demo-desc">å•ä¸ªå¤é€‰æ¡†ç»‘å®šå¸ƒå°”å€¼ï¼Œå¤šä¸ªç»‘å®šæ•°ç»„</p>
        <DemoBox 
          demoPath="directives/v-model-checkbox"
          title="å¤é€‰æ¡†å’Œå•é€‰æ¡†"
          height="720px"
        />
      </div>

      <!-- Demo 3: ä¸‹æ‹‰é€‰æ‹© -->
      <div class="demo-section">
        <h4>Demo 3: ä¸‹æ‹‰é€‰æ‹©æ¡†</h4>
        <p class="demo-desc">å•é€‰å’Œå¤šé€‰ä¸‹æ‹‰æ¡†çš„ä½¿ç”¨</p>
        <DemoBox 
          demoPath="directives/v-model-select"
          title="ä¸‹æ‹‰é€‰æ‹©æ¡†"
          height="750px"
        />
      </div>

      <!-- Demo 4: ä¿®é¥°ç¬¦ -->
      <div class="demo-section">
        <h4>Demo 4: v-model ä¿®é¥°ç¬¦</h4>
        <p class="demo-desc">.lazyã€.numberã€.trim çš„ä½¿ç”¨</p>
        <DemoBox 
          demoPath="directives/v-model-modifiers"
          title="v-model ä¿®é¥°ç¬¦"
          height="800px"
        />
      </div>
    </KnowledgeCard>

    <!-- ç»‘å®šè§„åˆ™æ€»ç»“ -->
    <KnowledgeCard title="ğŸ“Š ä¸åŒè¡¨å•å…ƒç´ çš„ç»‘å®š">
      <div class="binding-table">
        <div class="binding-row header">
          <div class="binding-cell">è¡¨å•å…ƒç´ </div>
          <div class="binding-cell">ç»‘å®šçš„å€¼</div>
          <div class="binding-cell">æ•°æ®ç±»å‹</div>
        </div>
        <div class="binding-row">
          <div class="binding-cell">input[text]</div>
          <div class="binding-cell">value</div>
          <div class="binding-cell">å­—ç¬¦ä¸²</div>
        </div>
        <div class="binding-row">
          <div class="binding-cell">textarea</div>
          <div class="binding-cell">value</div>
          <div class="binding-cell">å­—ç¬¦ä¸²</div>
        </div>
        <div class="binding-row">
          <div class="binding-cell">input[checkbox]ï¼ˆå•ä¸ªï¼‰</div>
          <div class="binding-cell">checked</div>
          <div class="binding-cell">å¸ƒå°”å€¼</div>
        </div>
        <div class="binding-row">
          <div class="binding-cell">input[checkbox]ï¼ˆå¤šä¸ªï¼‰</div>
          <div class="binding-cell">value</div>
          <div class="binding-cell">æ•°ç»„</div>
        </div>
        <div class="binding-row">
          <div class="binding-cell">input[radio]</div>
          <div class="binding-cell">value</div>
          <div class="binding-cell">å­—ç¬¦ä¸²</div>
        </div>
        <div class="binding-row">
          <div class="binding-cell">select</div>
          <div class="binding-cell">value</div>
          <div class="binding-cell">å­—ç¬¦ä¸²/å¯¹è±¡</div>
        </div>
      </div>
    </KnowledgeCard>

    <!-- ä¿®é¥°ç¬¦ -->
    <TipBox type="info" title="ğŸ’¡ v-model ä¿®é¥°ç¬¦">
      <ul>
        <li><code>.lazy</code> - åœ¨ change äº‹ä»¶è€Œé input äº‹ä»¶æ—¶æ›´æ–°</li>
        <li><code>.number</code> - è‡ªåŠ¨å°†è¾“å…¥è½¬æ¢ä¸ºæ•°å­—ç±»å‹</li>
        <li><code>.trim</code> - è‡ªåŠ¨å»é™¤è¾“å…¥çš„é¦–å°¾ç©ºæ ¼</li>
      </ul>
    </TipBox>
  </div>
</template>

<script>
/**
 * v-model åŒå‘ç»‘å®šé¡µé¢
 */
import KnowledgeCard from '@/components/content/KnowledgeCard.vue'
import TipBox from '@/components/content/TipBox.vue'
import DemoBox from '@/components/demo/DemoBox.vue'
import CodeBlock from '@/components/demo/CodeBlock.vue'
import scrollTrackingMixin from '@/utils/scrollTrackingMixin'

export default {
  name: 'VModel',

  mixins: [scrollTrackingMixin],

  components: {
    KnowledgeCard,
    TipBox,
    DemoBox,
    CodeBlock
  },

  data() {
    return {
      essenceCode: `<!-- v-model æ˜¯è¯­æ³•ç³– -->
<input v-model="message">

<!-- ç­‰ä»·äº -->
<input 
  :value="message" 
  @input="message = $event.target.value"
>`
    }
  }
}
</script>

<style lang="scss" scoped>
.v-model-page {
  .page-header {
    margin-bottom: $spacing-xl;
    
    h1 {
      font-size: 28px;
      margin-bottom: $spacing-sm;
    }
    
    .page-desc {
      color: $color-text-secondary;
      font-size: 16px;
    }
  }

  .flow-diagram {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: $spacing-md;
    margin: $spacing-lg 0;

    .flow-box {
      padding: $spacing-md $spacing-lg;
      background: $color-bg;
      border-radius: $radius-md;
      font-weight: 600;
    }

    .flow-arrow {
      font-size: 24px;
      color: $color-primary;
    }
  }

  .analogy-box {
    display: flex;
    align-items: flex-start;
    gap: $spacing-md;
    padding: $spacing-md;
    background: rgba($color-primary, 0.05);
    border-radius: $radius-md;

    .analogy-icon {
      font-size: 24px;
    }
  }

  .demo-section {
    margin-bottom: $spacing-xl;

    h4 {
      font-size: 16px;
      margin-bottom: $spacing-xs;
    }

    .demo-desc {
      color: $color-text-secondary;
      font-size: 14px;
      margin-bottom: $spacing-md;
    }
  }

  .binding-table {
    border-radius: $radius-md;
    overflow: hidden;
    border: 1px solid $color-border;

    .binding-row {
      display: grid;
      grid-template-columns: 1.5fr 1fr 1fr;

      &.header {
        background: $color-bg;
        font-weight: 600;
        font-size: 14px;
      }

      .binding-cell {
        padding: $spacing-sm $spacing-md;
        border-bottom: 1px solid $color-border;
        font-size: 14px;
      }

      &:last-child .binding-cell {
        border-bottom: none;
      }
    }
  }
}
</style>

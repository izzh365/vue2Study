<template>
  <div class="knowledge-page">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="page-header">
      <h1>â¡ï¸ ç®­å¤´å‡½æ•°</h1>
      <p class="subtitle">æ›´ç®€æ´çš„å‡½æ•°å†™æ³•ï¼Œæ›´é‡è¦çš„æ˜¯è§£å†³äº† this é—®é¢˜</p>
    </div>

    <!-- 1. æ¦‚å¿µè¯´æ˜ -->
    <KnowledgeCard title="ğŸ“– æ¦‚å¿µè¯´æ˜ï¼ˆæ˜¯ä»€ä¹ˆï¼‰">
      <div class="concept-content">
        <h4>ğŸ¯ é€šä¿—æ¯”å–»</h4>
        <p>ç®­å¤´å‡½æ•°å°±åƒç®€åŒ–çš„è¯´è¯æ–¹å¼ï¼š</p>
        <ul>
          <li>ä¼ ç»Ÿï¼š<code>function(x) { return x * 2 }</code></li>
          <li>ç®­å¤´ï¼š<code>x => x * 2</code></li>
        </ul>
        <p>åƒå‘çŸ­ä¿¡æ—¶ç”¨ç¼©å†™ä¸€æ ·ï¼Œæ„æ€ä¸å˜ä½†æ›´ç®€çŸ­ï¼</p>
        
        <h4>ğŸ“š ç®­å¤´å‡½æ•°ç‰¹ç‚¹</h4>
        <ul>
          <li><strong>è¯­æ³•æ›´ç®€æ´</strong>ï¼šçœç•¥ function å…³é”®å­—</li>
          <li><strong>æ²¡æœ‰è‡ªå·±çš„ this</strong>ï¼šç»§æ‰¿å¤–å±‚ä½œç”¨åŸŸçš„ thisï¼ˆæœ€é‡è¦ï¼ï¼‰</li>
          <li><strong>ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°</strong>ï¼šä¸èƒ½ç”¨ new è°ƒç”¨</li>
          <li><strong>æ²¡æœ‰ arguments</strong>ï¼šä½¿ç”¨ rest å‚æ•°ä»£æ›¿</li>
        </ul>
      </div>
    </KnowledgeCard>

    <!-- 2. è¯­æ³•è¯´æ˜ -->
    <KnowledgeCard title="ğŸ“ è¯­æ³•ç®€å†™è§„åˆ™">
      <CodeBlock :code="syntaxCode" language="javascript" />
    </KnowledgeCard>

    <!-- Demo åˆ—è¡¨ -->
    <h2 class="section-title">ğŸ¯ å®æˆ˜æ¼”ç¤º</h2>

    <!-- Demo 1: åŸºæœ¬è¯­æ³• -->
    <KnowledgeCard title="Demo 1ï¼šç®­å¤´å‡½æ•°åŸºæœ¬è¯­æ³•">
      <p class="demo-desc">äº†è§£ç®­å¤´å‡½æ•°çš„å„ç§å†™æ³•</p>
      <DemoBox 
        demoPath="es6/arrow-syntax"
        title="åŸºæœ¬è¯­æ³•"
        :height="320"
      />
    </KnowledgeCard>

    <!-- Demo 2: å‚æ•°ç®€å†™ -->
    <KnowledgeCard title="Demo 2ï¼šå‚æ•°ç®€å†™è§„åˆ™">
      <p class="demo-desc">å•å‚æ•°å¯çœç•¥æ‹¬å·ï¼Œæ— å‚æ•°æˆ–å¤šå‚æ•°éœ€è¦æ‹¬å·</p>
      <DemoBox 
        demoPath="es6/arrow-params"
        title="å‚æ•°ç®€å†™"
        :height="300"
      />
    </KnowledgeCard>

    <!-- Demo 3: è¿”å›å€¼ç®€å†™ -->
    <KnowledgeCard title="Demo 3ï¼šè¿”å›å€¼ç®€å†™è§„åˆ™">
      <p class="demo-desc">å•è¡¨è¾¾å¼å¯çœç•¥ {} å’Œ returnï¼Œè¿”å›å¯¹è±¡éœ€è¦åŠ æ‹¬å·</p>
      <DemoBox 
        demoPath="es6/arrow-return"
        title="è¿”å›å€¼ç®€å†™"
        :height="320"
      />
    </KnowledgeCard>

    <!-- Demo 4: this æŒ‡å‘ -->
    <KnowledgeCard title="Demo 4ï¼šthis æŒ‡å‘é—®é¢˜ï¼ˆæ ¸å¿ƒï¼ï¼‰">
      <p class="demo-desc">ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ thisï¼Œç»§æ‰¿å¤–å±‚ä½œç”¨åŸŸ</p>
      <DemoBox 
        demoPath="es6/arrow-this"
        title="this æŒ‡å‘"
        :height="400"
      />
    </KnowledgeCard>

    <!-- Demo 5: Vue ä¸­åº”ç”¨ -->
    <KnowledgeCard title="Demo 5ï¼šåœ¨ Vue ä¸­çš„åº”ç”¨">
      <p class="demo-desc">setTimeoutã€æ•°ç»„æ–¹æ³•ç­‰åœºæ™¯ä¸­ä½¿ç”¨ç®­å¤´å‡½æ•°</p>
      <DemoBox 
        demoPath="es6/arrow-vue"
        title="Vue ä¸­åº”ç”¨"
        :height="380"
      />
    </KnowledgeCard>

    <!-- Demo 6: æ³¨æ„äº‹é¡¹ -->
    <KnowledgeCard title="Demo 6ï¼šä½¿ç”¨æ³¨æ„äº‹é¡¹">
      <p class="demo-desc">å“ªäº›åœºæ™¯ä¸é€‚åˆä½¿ç”¨ç®­å¤´å‡½æ•°</p>
      <DemoBox 
        demoPath="es6/arrow-caution"
        title="æ³¨æ„äº‹é¡¹"
        :height="360"
      />
    </KnowledgeCard>

    <!-- this å¯¹æ¯” -->
    <KnowledgeCard title="ğŸ“Š this æŒ‡å‘å¯¹æ¯”">
      <table class="compare-table">
        <thead>
          <tr>
            <th>åœºæ™¯</th>
            <th>æ™®é€šå‡½æ•° this</th>
            <th>ç®­å¤´å‡½æ•° this</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>å¯¹è±¡æ–¹æ³•</td>
            <td>è°ƒç”¨è¯¥æ–¹æ³•çš„å¯¹è±¡</td>
            <td>å¤–å±‚ä½œç”¨åŸŸï¼ˆé€šå¸¸æ˜¯ windowï¼‰</td>
          </tr>
          <tr>
            <td>setTimeout å›è°ƒ</td>
            <td>window</td>
            <td>å¤–å±‚ä½œç”¨åŸŸ</td>
          </tr>
          <tr>
            <td>äº‹ä»¶ç›‘å¬å™¨</td>
            <td>è§¦å‘äº‹ä»¶çš„å…ƒç´ </td>
            <td>å¤–å±‚ä½œç”¨åŸŸ</td>
          </tr>
          <tr>
            <td>Vue methods</td>
            <td>Vue å®ä¾‹</td>
            <td>âŒ ä¸è¦ä½¿ç”¨ç®­å¤´å‡½æ•°</td>
          </tr>
        </tbody>
      </table>
    </KnowledgeCard>

    <!-- æ³¨æ„äº‹é¡¹ -->
    <TipBox type="error" title="âŒ ä¸è¦åœ¨è¿™äº›åœºæ™¯ä½¿ç”¨ç®­å¤´å‡½æ•°">
      <ul>
        <li><strong>Vue çš„ methods</strong>ï¼šéœ€è¦ this æŒ‡å‘ Vue å®ä¾‹</li>
        <li><strong>Vue çš„ computed</strong>ï¼šåŒä¸Š</li>
        <li><strong>Vue çš„ç”Ÿå‘½å‘¨æœŸé’©å­</strong>ï¼šåŒä¸Š</li>
        <li><strong>å¯¹è±¡çš„æ–¹æ³•</strong>ï¼šéœ€è¦ this æŒ‡å‘å¯¹è±¡æœ¬èº«</li>
        <li><strong>æ„é€ å‡½æ•°</strong>ï¼šç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ new</li>
      </ul>
    </TipBox>

    <TipBox type="success" title="âœ… æ¨èä½¿ç”¨ç®­å¤´å‡½æ•°çš„åœºæ™¯">
      <ul>
        <li><strong>å›è°ƒå‡½æ•°</strong>ï¼šsetTimeoutã€setIntervalã€Promise.then</li>
        <li><strong>æ•°ç»„æ–¹æ³•</strong>ï¼šmapã€filterã€reduceã€forEach</li>
        <li><strong>Vue methods ä¸­çš„å›è°ƒ</strong>ï¼šåœ¨æ–¹æ³•å†…éƒ¨ä½¿ç”¨çš„å›è°ƒ</li>
      </ul>
    </TipBox>
  </div>
</template>

<script>
/**
 * @description ç®­å¤´å‡½æ•°çŸ¥è¯†ç‚¹é¡µé¢
 * @author Vue2 Learning Project
 */
import KnowledgeCard from '@/components/content/KnowledgeCard.vue'
import TipBox from '@/components/content/TipBox.vue'
import CodeBlock from '@/components/demo/CodeBlock.vue'
import DemoBox from '@/components/demo/DemoBox.vue'

export default {
  name: 'ArrowFunction',
  
  components: {
    KnowledgeCard,
    TipBox,
    CodeBlock,
    DemoBox
  },
  
  data() {
    return {
      syntaxCode: `// ==================== åŸºæœ¬è¯­æ³• ====================
// ä¼ ç»Ÿå†™æ³•
const add = function(a, b) {
  return a + b
}

// ç®­å¤´å‡½æ•°
const add = (a, b) => {
  return a + b
}


// ==================== ç®€å†™è§„åˆ™ ====================

// 1ï¸âƒ£ å•å‚æ•°ï¼šå¯ä»¥çœç•¥æ‹¬å·
const double = x => x * 2
// ç­‰åŒäº: const double = (x) => { return x * 2 }

// 2ï¸âƒ£ æ— å‚æ•°æˆ–å¤šå‚æ•°ï¼šå¿…é¡»åŠ æ‹¬å·
const sayHi = () => console.log('Hi')
const add = (a, b) => a + b

// 3ï¸âƒ£ å•è¡¨è¾¾å¼ï¼šå¯ä»¥çœç•¥ {} å’Œ return
const square = x => x * x
// ç­‰åŒäº: const square = x => { return x * x }

// 4ï¸âƒ£ è¿”å›å¯¹è±¡ï¼šå¿…é¡»ç”¨æ‹¬å·åŒ…è£¹
const getUser = () => ({ name: 'å¼ ä¸‰', age: 18 })
// å¦‚æœä¸åŠ æ‹¬å·ï¼Œ{} ä¼šè¢«å½“ä½œå‡½æ•°ä½“


// ==================== this ç»§æ‰¿ ====================
const obj = {
  name: 'Vue',
  
  // âŒ æ™®é€šå‡½æ•°ï¼šsetTimeout ä¸­ this æ˜¯ window
  sayLater1() {
    setTimeout(function() {
      console.log(this.name)  // undefined
    }, 1000)
  },
  
  // âœ… ç®­å¤´å‡½æ•°ï¼šç»§æ‰¿å¤–å±‚çš„ this
  sayLater2() {
    setTimeout(() => {
      console.log(this.name)  // 'Vue'
    }, 1000)
  }
}`
    }
  }
}
</script>

<style lang="scss" scoped>
.knowledge-page {
  max-width: 900px;
  margin: 0 auto;
}

.page-header {
  margin-bottom: $spacing-xl;
  
  h1 {
    font-size: $font-size-3xl;
    margin-bottom: $spacing-sm;
  }
  
  .subtitle {
    color: $color-text-secondary;
    font-size: $font-size-lg;
  }
}

.section-title {
  font-size: $font-size-xl;
  margin: $spacing-xl 0 $spacing-lg;
  padding-bottom: $spacing-sm;
  border-bottom: 2px solid $color-primary;
}

.demo-desc {
  color: $color-text-secondary;
  margin-bottom: $spacing-md;
}

.concept-content {
  h4 {
    color: $color-primary;
    margin: $spacing-md 0 $spacing-sm;
    
    &:first-child {
      margin-top: 0;
    }
  }
  
  ul {
    padding-left: $spacing-lg;
    
    li {
      margin-bottom: $spacing-xs;
      line-height: 1.8;
    }
  }
  
  code {
    background: $color-code-bg;
    padding: 2px 6px;
    border-radius: 4px;
    font-family: $font-family-code;
    color: $color-primary;
  }
}

.compare-table {
  width: 100%;
  border-collapse: collapse;
  
  th, td {
    padding: $spacing-sm $spacing-md;
    text-align: left;
    border: 1px solid $color-border;
  }
  
  th {
    background: $color-bg;
    font-weight: 600;
  }
}
</style>

<template>
  <div class="knowledge-page">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="page-header">
      <h1>ğŸš€ é«˜é˜¶å‡½æ•°</h1>
      <p class="subtitle">filterã€mapã€reduce æ˜¯æ•°ç»„å¤„ç†çš„ä¸‰å‰‘å®¢</p>
    </div>

    <!-- 1. æ¦‚å¿µè¯´æ˜ -->
    <KnowledgeCard title="ğŸ“– æ¦‚å¿µè¯´æ˜ï¼ˆæ˜¯ä»€ä¹ˆï¼‰">
      <div class="concept-content">
        <h4>ğŸ¯ é€šä¿—æ¯”å–»</h4>
        <p>æƒ³è±¡ä½ æœ‰ä¸€ç­è‹¹æœè¦å¤„ç†ï¼š</p>
        <ul>
          <li><strong>filterï¼ˆè¿‡æ»¤ï¼‰</strong>ï¼šæŒ‘å‡ºçº¢è‹¹æœï¼Œæ‰”æ‰åçš„</li>
          <li><strong>mapï¼ˆæ˜ å°„ï¼‰</strong>ï¼šæŠŠæ¯ä¸ªè‹¹æœå‰Šçš®ï¼Œå˜æˆè‹¹æœç‰‡</li>
          <li><strong>reduceï¼ˆå½’çº¦ï¼‰</strong>ï¼šæŠŠæ‰€æœ‰è‹¹æœç‰‡æ”¾è¿›æ¦¨æ±æœºï¼Œå˜æˆä¸€æ¯æœæ±</li>
        </ul>
        
        <h4>ğŸ“š å®˜æ–¹å®šä¹‰</h4>
        <p><strong>é«˜é˜¶å‡½æ•°</strong>ï¼šæ¥æ”¶å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæˆ–è¿”å›ä¸€ä¸ªå‡½æ•°çš„å‡½æ•°</p>
        
        <h4>ğŸ”¥ æ ¸å¿ƒä¸‰å‰‘å®¢</h4>
        <ul>
          <li><code>filter()</code>ï¼šè¿‡æ»¤æ•°ç»„ï¼Œè¿”å›æ»¡è¶³æ¡ä»¶çš„å…ƒç´ </li>
          <li><code>map()</code>ï¼šæ˜ å°„æ•°ç»„ï¼Œå¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œè½¬æ¢</li>
          <li><code>reduce()</code>ï¼šå½’çº¦æ•°ç»„ï¼Œå°†æ•°ç»„ç´¯ç§¯ä¸ºå•ä¸€å€¼</li>
        </ul>
      </div>
    </KnowledgeCard>

    <!-- 2. è¯­æ³•æ¦‚è§ˆ -->
    <KnowledgeCard title="ğŸ“ è¯­æ³•æ¦‚è§ˆ">
      <CodeBlock :code="syntaxCode" language="javascript" />
    </KnowledgeCard>

    <!-- Demo åˆ—è¡¨ -->
    <h2 class="section-title">ğŸ¯ å®æˆ˜æ¼”ç¤º</h2>

    <!-- Demo 1: filter åŸºç¡€ -->
    <KnowledgeCard title="Demo 1ï¼šfilter è¿‡æ»¤æ•°ç»„">
      <p class="demo-desc">filter è¿”å›æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ç»„æˆçš„æ–°æ•°ç»„ï¼Œä¸ä¿®æ”¹åŸæ•°ç»„</p>
      <DemoBox 
        demoPath="es6/filter-basic"
        title="filter åŸºæœ¬ç”¨æ³•"
        :height="320"
      />
    </KnowledgeCard>

    <!-- Demo 2: filter è¿›é˜¶ -->
    <KnowledgeCard title="Demo 2ï¼šfilter è¿›é˜¶åº”ç”¨">
      <p class="demo-desc">è¿‡æ»¤å¯¹è±¡æ•°ç»„ï¼Œå®ç°æœç´¢ã€ç­›é€‰åŠŸèƒ½</p>
      <DemoBox 
        demoPath="es6/filter-advanced"
        title="filter è¿‡æ»¤å¯¹è±¡æ•°ç»„"
        :height="360"
      />
    </KnowledgeCard>

    <!-- Demo 3: map åŸºç¡€ -->
    <KnowledgeCard title="Demo 3ï¼šmap æ˜ å°„æ•°ç»„">
      <p class="demo-desc">map å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œè½¬æ¢ï¼Œè¿”å›æ–°æ•°ç»„</p>
      <DemoBox 
        demoPath="es6/map-basic"
        title="map åŸºæœ¬ç”¨æ³•"
        :height="320"
      />
    </KnowledgeCard>

    <!-- Demo 4: map è¿›é˜¶ -->
    <KnowledgeCard title="Demo 4ï¼šmap è¿›é˜¶åº”ç”¨">
      <p class="demo-desc">æå–å¯¹è±¡å±æ€§ã€æ•°æ®æ ¼å¼è½¬æ¢</p>
      <DemoBox 
        demoPath="es6/map-advanced"
        title="map æ•°æ®è½¬æ¢"
        :height="360"
      />
    </KnowledgeCard>

    <!-- Demo 5: reduce åŸºç¡€ -->
    <KnowledgeCard title="Demo 5ï¼šreduce å½’çº¦æ•°ç»„">
      <p class="demo-desc">reduce å°†æ•°ç»„ç´¯ç§¯ä¸ºå•ä¸€å€¼ï¼Œå¦‚æ±‚å’Œã€æ±‚ç§¯</p>
      <DemoBox 
        demoPath="es6/reduce-basic"
        title="reduce åŸºæœ¬ç”¨æ³•"
        :height="340"
      />
    </KnowledgeCard>

    <!-- Demo 6: reduce è¿›é˜¶ -->
    <KnowledgeCard title="Demo 6ï¼šreduce è¿›é˜¶åº”ç”¨">
      <p class="demo-desc">æ•°ç»„å»é‡ã€åˆ†ç»„ã€æ‰å¹³åŒ–ç­‰é«˜çº§ç”¨æ³•</p>
      <DemoBox 
        demoPath="es6/reduce-advanced"
        title="reduce é«˜çº§ç”¨æ³•"
        :height="380"
      />
    </KnowledgeCard>

    <!-- Demo 7: é“¾å¼è°ƒç”¨ -->
    <KnowledgeCard title="Demo 7ï¼šé“¾å¼è°ƒç”¨ï¼ˆé‡ç‚¹ï¼ï¼‰">
      <p class="demo-desc">filter + map + reduce ç»„åˆä½¿ç”¨ï¼Œä¼˜é›…å¤„ç†å¤æ‚æ•°æ®</p>
      <DemoBox 
        demoPath="es6/chain-methods"
        title="é“¾å¼è°ƒç”¨"
        :height="400"
      />
    </KnowledgeCard>

    <!-- Demo 8: å®æˆ˜æ¡ˆä¾‹ -->
    <KnowledgeCard title="Demo 8ï¼šè´­ç‰©è½¦è®¡ç®—å®æˆ˜">
      <p class="demo-desc">ç»¼åˆè¿ç”¨ä¸‰ä¸ªæ–¹æ³•å®ç°è´­ç‰©è½¦ä»·æ ¼è®¡ç®—</p>
      <DemoBox 
        demoPath="es6/practical-example"
        title="è´­ç‰©è½¦å®æˆ˜"
        :height="420"
      />
    </KnowledgeCard>

    <!-- å¯¹æ¯”è¡¨æ ¼ -->
    <KnowledgeCard title="ğŸ“Š ä¸‰å¤§é«˜é˜¶å‡½æ•°å¯¹æ¯”">
      <table class="compare-table">
        <thead>
          <tr>
            <th>æ–¹æ³•</th>
            <th>ä½œç”¨</th>
            <th>è¿”å›å€¼</th>
            <th>å¸¸ç”¨åœºæ™¯</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>filter()</code></td>
            <td>è¿‡æ»¤ç­›é€‰</td>
            <td>æ–°æ•°ç»„ï¼ˆå…ƒç´ å¯èƒ½å‡å°‘ï¼‰</td>
            <td>æœç´¢ã€ç­›é€‰æ¡ä»¶</td>
          </tr>
          <tr>
            <td><code>map()</code></td>
            <td>æ˜ å°„è½¬æ¢</td>
            <td>æ–°æ•°ç»„ï¼ˆé•¿åº¦ä¸å˜ï¼‰</td>
            <td>æ•°æ®æ ¼å¼åŒ–ã€æå–å­—æ®µ</td>
          </tr>
          <tr>
            <td><code>reduce()</code></td>
            <td>å½’çº¦ç´¯ç§¯</td>
            <td>å•ä¸€å€¼ï¼ˆä»»æ„ç±»å‹ï¼‰</td>
            <td>æ±‚å’Œã€ç»Ÿè®¡ã€å»é‡</td>
          </tr>
        </tbody>
      </table>
    </KnowledgeCard>

    <!-- æ³¨æ„äº‹é¡¹ -->
    <TipBox type="warning" title="âš ï¸ æ³¨æ„äº‹é¡¹">
      <ul>
        <li>è¿™ä¸‰ä¸ªæ–¹æ³•éƒ½<strong>ä¸ä¼šä¿®æ”¹åŸæ•°ç»„</strong>ï¼Œè¿”å›æ–°æ•°ç»„/å€¼</li>
        <li>å›è°ƒå‡½æ•°ä¸­ return æ˜¯å¿…é¡»çš„ï¼Œå¦åˆ™ç»“æœå¯èƒ½ä¸ç¬¦åˆé¢„æœŸ</li>
        <li>reduce çš„ç¬¬äºŒä¸ªå‚æ•°ï¼ˆåˆå§‹å€¼ï¼‰å»ºè®®æ€»æ˜¯ä¼ é€’</li>
        <li>ç©ºæ•°ç»„è°ƒç”¨ reduce ä¸”æ²¡æœ‰åˆå§‹å€¼ä¼šæŠ¥é”™</li>
      </ul>
    </TipBox>
  </div>
</template>

<script>
/**
 * @description é«˜é˜¶å‡½æ•°çŸ¥è¯†ç‚¹é¡µé¢
 * @author Vue2 Learning Project
 */
import KnowledgeCard from '@/components/content/KnowledgeCard.vue'
import TipBox from '@/components/content/TipBox.vue'
import CodeBlock from '@/components/demo/CodeBlock.vue'
import DemoBox from '@/components/demo/DemoBox.vue'

export default {
  name: 'HigherOrder',
  
  components: {
    KnowledgeCard,
    TipBox,
    CodeBlock,
    DemoBox
  },
  
  data() {
    return {
      syntaxCode: `// ==================== filter è¿‡æ»¤ ====================
const numbers = [1, 2, 3, 4, 5, 6]

// è¿”å› true çš„å…ƒç´ ä¼šè¢«ä¿ç•™
const evenNumbers = numbers.filter(num => num % 2 === 0)
// ç»“æœ: [2, 4, 6]


// ==================== map æ˜ å°„ ====================
const prices = [100, 200, 300]

// æ¯ä¸ªå…ƒç´ éƒ½ä¼šè¢«è½¬æ¢
const discounted = prices.map(price => price * 0.8)
// ç»“æœ: [80, 160, 240]


// ==================== reduce å½’çº¦ ====================
const scores = [85, 90, 78, 92]

// ç´¯ç§¯è®¡ç®—
const total = scores.reduce((sum, score) => sum + score, 0)
// ç»“æœ: 345

// reduce å‚æ•°è¯´æ˜:
// reduce((ç´¯ç§¯å€¼, å½“å‰å…ƒç´ , å½“å‰ç´¢å¼•, åŸæ•°ç»„) => æ–°ç´¯ç§¯å€¼, åˆå§‹å€¼)


// ==================== é“¾å¼è°ƒç”¨ ====================
const products = [
  { name: 'è‹¹æœ', price: 5, count: 3 },
  { name: 'é¦™è•‰', price: 3, count: 5 },
  { name: 'æ©™å­', price: 8, count: 2 }
]

// è®¡ç®—ä»·æ ¼ > 4 çš„å•†å“æ€»ä»·
const total = products
  .filter(item => item.price > 4)        // è¿‡æ»¤: è‹¹æœã€æ©™å­
  .map(item => item.price * item.count)  // æ˜ å°„: [15, 16]
  .reduce((sum, n) => sum + n, 0)        // å½’çº¦: 31`
    }
  }
}
</script>

<style lang="scss" scoped>
.knowledge-page {
  max-width: 900px;
  margin: 0 auto;
}

.page-header {
  margin-bottom: $spacing-xl;
  
  h1 {
    font-size: $font-size-3xl;
    margin-bottom: $spacing-sm;
  }
  
  .subtitle {
    color: $color-text-secondary;
    font-size: $font-size-lg;
  }
}

.section-title {
  font-size: $font-size-xl;
  margin: $spacing-xl 0 $spacing-lg;
  padding-bottom: $spacing-sm;
  border-bottom: 2px solid $color-primary;
}

.demo-desc {
  color: $color-text-secondary;
  margin-bottom: $spacing-md;
}

.concept-content {
  h4 {
    color: $color-primary;
    margin: $spacing-md 0 $spacing-sm;
    
    &:first-child {
      margin-top: 0;
    }
  }
  
  ul {
    padding-left: $spacing-lg;
    
    li {
      margin-bottom: $spacing-xs;
      line-height: 1.8;
    }
  }
  
  code {
    background: $color-code-bg;
    padding: 2px 6px;
    border-radius: 4px;
    font-family: $font-family-code;
    color: $color-primary;
  }
}

.compare-table {
  width: 100%;
  border-collapse: collapse;
  
  th, td {
    padding: $spacing-sm $spacing-md;
    text-align: left;
    border: 1px solid $color-border;
  }
  
  th {
    background: $color-bg;
    font-weight: 600;
  }
  
  code {
    background: $color-code-bg;
    padding: 2px 6px;
    border-radius: 4px;
    font-family: $font-family-code;
    color: $color-primary;
  }
}
</style>

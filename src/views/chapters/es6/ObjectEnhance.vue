<template>
  <div class="knowledge-page">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="page-header">
      <h1>âœ¨ å¯¹è±¡å¢å¼ºå†™æ³•</h1>
      <p class="subtitle">ES6 è®©å¯¹è±¡å­—é¢é‡å†™æ³•æ›´åŠ ç®€æ´ä¼˜é›…</p>
    </div>

    <!-- 1. æ¦‚å¿µè¯´æ˜ -->
    <KnowledgeCard title="ğŸ“– æ¦‚å¿µè¯´æ˜ï¼ˆæ˜¯ä»€ä¹ˆï¼‰">
      <div class="concept-content">
        <h4>ğŸ¯ é€šä¿—æ¯”å–»</h4>
        <p>æƒ³è±¡ä½ åœ¨å¡«å†™ä¸€å¼ è¡¨æ ¼ï¼š</p>
        <div class="analogy-box">
          <p>ğŸ“ <strong>ä¼ ç»Ÿæ–¹å¼ï¼ˆES5ï¼‰</strong>ï¼šå§“åæ å†™"å§“åï¼šå¼ ä¸‰"ï¼Œå¹´é¾„æ å†™"å¹´é¾„ï¼š18"</p>
          <p>âœ¨ <strong>ç®€æ´æ–¹å¼ï¼ˆES6ï¼‰</strong>ï¼šå§“åæ ç›´æ¥å†™"å¼ ä¸‰"ï¼Œå¹´é¾„æ ç›´æ¥å†™"18"ï¼ˆæ ä½åå·²ç»è¯´æ˜äº†ï¼‰</p>
        </div>
        <p class="mt-md">ä»£ç å¯¹æ¯”ï¼š</p>
        <ul>
          <li>ES5 å†™æ³•ï¼š<code>{ name: name, age: age }</code> â†’ é‡å¤å†™ä¸¤éå˜é‡å</li>
          <li>ES6 ç®€å†™ï¼š<code>{ name, age }</code> â†’ å˜é‡åå’Œå±æ€§åç›¸åŒæ—¶ï¼Œåªå†™ä¸€ä¸ª</li>
        </ul>
        
        <h4>ğŸ“š ä¸‰ç§å¢å¼ºå†™æ³•</h4>
        <div class="feature-grid">
          <div class="feature-item">
            <span class="feature-icon">1ï¸âƒ£</span>
            <div>
              <strong>å±æ€§ç®€å†™</strong>
              <p>å˜é‡åå’Œå±æ€§åç›¸åŒæ—¶ï¼Œå¯ä»¥åªå†™ä¸€ä¸ª</p>
            </div>
          </div>
          <div class="feature-item">
            <span class="feature-icon">2ï¸âƒ£</span>
            <div>
              <strong>æ–¹æ³•ç®€å†™</strong>
              <p>çœç•¥ <code>function</code> å…³é”®å­—ï¼Œæ›´ç®€æ´</p>
            </div>
          </div>
          <div class="feature-item">
            <span class="feature-icon">3ï¸âƒ£</span>
            <div>
              <strong>è®¡ç®—å±æ€§å</strong>
              <p>ç”¨ <code>[]</code> åŒ…è£¹è¡¨è¾¾å¼åŠ¨æ€è®¾ç½®å±æ€§å</p>
            </div>
          </div>
        </div>
      </div>
    </KnowledgeCard>

    <!-- 1.5 ä¸ºä»€ä¹ˆéœ€è¦ -->
    <KnowledgeCard title="ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦å¯¹è±¡å¢å¼ºå†™æ³•">
      <div class="why-content">
        <h4>ğŸ˜¤ ES5 çš„ç—›ç‚¹</h4>
        <ul>
          <li><strong>é‡å¤ä»£ç å¤š</strong>ï¼š<code>{ name: name, age: age }</code> å˜é‡åè¦å†™ä¸¤é</li>
          <li><strong>æ–¹æ³•å®šä¹‰ç¹ç</strong>ï¼šæ¯æ¬¡éƒ½è¦å†™ <code>function</code> å…³é”®å­—</li>
          <li><strong>å±æ€§åä¸çµæ´»</strong>ï¼šæ— æ³•åŠ¨æ€è®¾ç½®å±æ€§å</li>
        </ul>
        
        <h4>âœ… ES6 è§£å†³æ–¹æ¡ˆ</h4>
        <ul>
          <li>ä»£ç æ›´ç®€æ´ï¼Œå‡å°‘é‡å¤</li>
          <li>Vue ç»„ä»¶ä¸­å¤§é‡ä½¿ç”¨ï¼Œå¿…é¡»æŒæ¡</li>
          <li>é…åˆè§£æ„èµ‹å€¼ï¼Œæ•°æ®å¤„ç†æ›´æ–¹ä¾¿</li>
        </ul>
        
        <h4>ğŸ“Š å®é™…æ•ˆæœå¯¹æ¯”</h4>
        <div class="compare-block">
          <div class="compare-item bad">
            <span class="label">âŒ ES5 - 38ä¸ªå­—ç¬¦</span>
            <code>{ name: name, age: age, city: city }</code>
          </div>
          <div class="compare-item good">
            <span class="label">âœ… ES6 - 18ä¸ªå­—ç¬¦</span>
            <code>{ name, age, city }</code>
          </div>
        </div>
      </div>
    </KnowledgeCard>

    <!-- 2. è¯­æ³•å¯¹æ¯” -->
    <KnowledgeCard title="ğŸ“ è¯­æ³•å¯¹æ¯”">
      <CodeBlock :code="syntaxCode" language="javascript" />
    </KnowledgeCard>

    <!-- Demo åˆ—è¡¨ -->
    <h2 class="section-title">ğŸ¯ å®æˆ˜æ¼”ç¤º</h2>

    <!-- Demo 1: å±æ€§ç®€å†™ -->
    <KnowledgeCard title="Demo 1ï¼šå±æ€§ç®€å†™">
      <p class="demo-desc">å½“å˜é‡åå’Œå±æ€§åç›¸åŒæ—¶ï¼Œå¯ä»¥çœç•¥å†’å·å’Œå€¼</p>
      <DemoBox 
        demoPath="es6/property-shorthand"
        title="å±æ€§ç®€å†™"
        :height="300"
      />
    </KnowledgeCard>

    <!-- Demo 2: æ–¹æ³•ç®€å†™ -->
    <KnowledgeCard title="Demo 2ï¼šæ–¹æ³•ç®€å†™">
      <p class="demo-desc">å¯¹è±¡ä¸­çš„æ–¹æ³•å¯ä»¥çœç•¥ function å…³é”®å­—</p>
      <DemoBox 
        demoPath="es6/method-shorthand"
        title="æ–¹æ³•ç®€å†™"
        :height="300"
      />
    </KnowledgeCard>

    <!-- Demo 3: è®¡ç®—å±æ€§å -->
    <KnowledgeCard title="Demo 3ï¼šè®¡ç®—å±æ€§å">
      <p class="demo-desc">ä½¿ç”¨ [] å¯ä»¥åŠ¨æ€è®¾ç½®å±æ€§å</p>
      <DemoBox 
        demoPath="es6/computed-property"
        title="è®¡ç®—å±æ€§å"
        :height="320"
      />
    </KnowledgeCard>

    <!-- Demo 4: å¯¹è±¡è§£æ„ -->
    <KnowledgeCard title="Demo 4ï¼šå¯¹è±¡è§£æ„èµ‹å€¼">
      <p class="demo-desc">å¿«é€Ÿä»å¯¹è±¡ä¸­æå–å±æ€§åˆ°å˜é‡</p>
      <DemoBox 
        demoPath="es6/object-destructuring"
        title="å¯¹è±¡è§£æ„"
        :height="340"
      />
    </KnowledgeCard>

    <!-- Demo 5: æ•°ç»„è§£æ„ -->
    <KnowledgeCard title="Demo 5ï¼šæ•°ç»„è§£æ„èµ‹å€¼">
      <p class="demo-desc">å¿«é€Ÿä»æ•°ç»„ä¸­æå–å…ƒç´ åˆ°å˜é‡</p>
      <DemoBox 
        demoPath="es6/array-destructuring"
        title="æ•°ç»„è§£æ„"
        :height="320"
      />
    </KnowledgeCard>

    <!-- æ³¨æ„äº‹é¡¹ -->
    <TipBox type="info" title="ğŸ’¡ åœ¨ Vue ä¸­çš„åº”ç”¨åœºæ™¯">
      <p>Vue ç»„ä»¶ä¸­å‡ ä¹æ¯å¤„éƒ½åœ¨ä½¿ç”¨ ES6 å¯¹è±¡å¢å¼ºå†™æ³•ï¼š</p>
      <ul>
        <li><strong>data() è¿”å›å€¼</strong>ï¼š<code>return { username, level }</code> å±æ€§ç®€å†™</li>
        <li><strong>methods å®šä¹‰</strong>ï¼š<code>handleClick() { ... }</code> æ–¹æ³•ç®€å†™</li>
        <li><strong>computed å®šä¹‰</strong>ï¼š<code>fullName() { return ... }</code> æ–¹æ³•ç®€å†™</li>
        <li><strong>components æ³¨å†Œ</strong>ï¼š<code>components: { Avatar, Button }</code> å±æ€§ç®€å†™</li>
        <li><strong>props è§£æ„</strong>ï¼š<code>const { name, age } = this.user</code> è§£æ„èµ‹å€¼</li>
      </ul>
    </TipBox>

    <TipBox type="warning" title="âš ï¸ æ³¨æ„äº‹é¡¹">
      <ul>
        <li><strong>æ–¹æ³•ç®€å†™ä¸­çš„ this</strong>ï¼šæ–¹æ³•ç®€å†™å’Œä¼ ç»Ÿå†™æ³•çš„ this æŒ‡å‘ç›¸åŒï¼Œéƒ½æŒ‡å‘ Vue å®ä¾‹</li>
        <li><strong>ä¸è¦ç”¨ç®­å¤´å‡½æ•°æ›¿ä»£æ–¹æ³•ç®€å†™</strong>ï¼šç®­å¤´å‡½æ•°çš„ this ä¸ä¼šæŒ‡å‘ Vue å®ä¾‹</li>
        <li><strong>è®¡ç®—å±æ€§åçš„æ€§èƒ½</strong>ï¼šå¤æ‚è¡¨è¾¾å¼ä½œä¸ºå±æ€§åä¼šå½±å“å¯è¯»æ€§ï¼Œé€‚åº¦ä½¿ç”¨</li>
      </ul>
    </TipBox>

    <!-- Vue å®æˆ˜ -->
    <KnowledgeCard title="ğŸ“¦ Vue ä¸­çš„å®é™…åº”ç”¨">
      <CodeBlock :code="vueExampleCode" language="javascript" />
    </KnowledgeCard>
  </div>
</template>

<script>
/**
 * @description å¯¹è±¡å¢å¼ºå†™æ³•çŸ¥è¯†ç‚¹é¡µé¢
 * @author Vue2 Learning Project
 */
import KnowledgeCard from '@/components/content/KnowledgeCard.vue'
import TipBox from '@/components/content/TipBox.vue'
import CodeBlock from '@/components/demo/CodeBlock.vue'
import DemoBox from '@/components/demo/DemoBox.vue'
import scrollTrackingMixin from '@/utils/scrollTrackingMixin'

export default {
  name: 'ObjectEnhance',
  
  mixins: [scrollTrackingMixin],
  
  components: {
    KnowledgeCard,
    TipBox,
    CodeBlock,
    DemoBox
  },
  
  data() {
    return {
      syntaxCode: `// ==================== ES5 ä¼ ç»Ÿå†™æ³• ====================
var name = 'å¼ ä¸‰'
var age = 18

// å±æ€§
var person = {
  name: name,
  age: age
}

// æ–¹æ³•
var obj = {
  sayHello: function() {
    console.log('Hello')
  }
}

// ==================== ES6 å¢å¼ºå†™æ³• ====================
const name = 'å¼ ä¸‰'
const age = 18

// 1. å±æ€§ç®€å†™
const person = { name, age }

// 2. æ–¹æ³•ç®€å†™
const obj = {
  sayHello() {
    console.log('Hello')
  }
}

// 3. è®¡ç®—å±æ€§å
const key = 'dynamicKey'
const data = {
  [key]: 'value',              // { dynamicKey: 'value' }
  ['pre_' + key]: 'prefixed'   // { pre_dynamicKey: 'prefixed' }
}`,

      vueExampleCode: `// =====================================================
// Vue ç»„ä»¶ä¸­å¤§é‡ä½¿ç”¨ ES6 å¢å¼ºå†™æ³• - è¿™æ˜¯ä½ æ¯å¤©éƒ½ä¼šå†™çš„ä»£ç ï¼
// =====================================================

export default {
  name: 'UserProfile',
  
  // âœ… ç»„ä»¶æ³¨å†Œ - å±æ€§ç®€å†™
  // å½“å¯¼å…¥çš„ç»„ä»¶åå’Œæ³¨å†Œåç›¸åŒæ—¶
  components: {
    Avatar,      // ç­‰åŒäº Avatar: Avatar
    Button,      // ç­‰åŒäº Button: Button
    UserCard     // ç­‰åŒäº UserCard: UserCard
  },
  
  // âœ… data å‡½æ•° - æ–¹æ³•ç®€å†™ + å±æ€§ç®€å†™
  data() {
    const username = 'å¼ ä¸‰'
    const level = 5
    const isVip = true
    
    // è¿”å›å¯¹è±¡ä½¿ç”¨å±æ€§ç®€å†™
    return { 
      username,  // ç­‰åŒäº username: username
      level,     // ç­‰åŒäº level: level
      isVip      // ç­‰åŒäº isVip: isVip
    }
  },
  
  // âœ… computed - æ–¹æ³•ç®€å†™
  computed: {
    // getter æ–¹æ³•ç®€å†™
    fullName() {
      return this.firstName + ' ' + this.lastName
    },
    
    // getter + setter å®Œæ•´å†™æ³•
    displayName: {
      get() {
        return this.firstName + ' ' + this.lastName
      },
      set(newValue) {
        const names = newValue.split(' ')
        this.firstName = names[0]
        this.lastName = names[names.length - 1]
      }
    },
    
    // è¿‡æ»¤åˆ—è¡¨ï¼ˆVue å®˜æ–¹ç¤ºä¾‹ï¼‰
    evenNumbers() {
      return this.numbers.filter(number => number % 2 === 0)
    }
  },
  
  // âœ… methods - æ–¹æ³•ç®€å†™
  methods: {
    // ä¸éœ€è¦å†™ function å…³é”®å­—
    handleClick() {
      console.log('æŒ‰é’®è¢«ç‚¹å‡»')
    },
    
    async fetchUserData() {
      const response = await fetch('/api/user')
      this.userData = await response.json()
    },
    
    // å¸¦å‚æ•°çš„æ–¹æ³•
    updateProfile(name, age) {
      this.name = name
      this.age = age
    }
  },
  
  // âœ… watch - æ–¹æ³•ç®€å†™
  watch: {
    username(newVal, oldVal) {
      console.log(\`ç”¨æˆ·åä» \${oldVal} å˜ä¸º \${newVal}\`)
    }
  }
}`
    }
  }
}
</script>

<style lang="scss" scoped>
.knowledge-page {
  max-width: 900px;
  margin: 0 auto;
}

.page-header {
  margin-bottom: $spacing-xl;
  
  h1 {
    font-size: $font-size-3xl;
    margin-bottom: $spacing-sm;
  }
  
  .subtitle {
    color: $color-text-secondary;
    font-size: $font-size-lg;
  }
}

.section-title {
  font-size: $font-size-xl;
  margin: $spacing-xl 0 $spacing-lg;
  padding-bottom: $spacing-sm;
  border-bottom: 2px solid $color-primary;
}

.demo-desc {
  color: $color-text-secondary;
  margin-bottom: $spacing-md;
}

.concept-content,
.why-content {
  h4 {
    color: $color-primary;
    margin: $spacing-md 0 $spacing-sm;
    
    &:first-child {
      margin-top: 0;
    }
  }
  
  ul {
    padding-left: $spacing-lg;
    
    li {
      margin-bottom: $spacing-xs;
      line-height: 1.8;
    }
  }
  
  code {
    background: $color-code-bg;
    padding: 2px 6px;
    border-radius: 4px;
    font-family: $font-family-code;
    color: $color-primary;
  }
}

// æ¯”å–»è¯´æ˜æ¡†
.analogy-box {
  background: linear-gradient(135deg, #f0f7ff 0%, #e8f4fd 100%);
  border-radius: $radius-md;
  padding: $spacing-md;
  margin: $spacing-sm 0;
  
  p {
    margin: $spacing-xs 0;
    line-height: 1.8;
  }
}

// ç‰¹æ€§ç½‘æ ¼
.feature-grid {
  display: grid;
  gap: $spacing-md;
  margin-top: $spacing-md;
  
  .feature-item {
    display: flex;
    align-items: flex-start;
    gap: $spacing-sm;
    background: $color-card;
    border: 1px solid $color-border;
    border-radius: $radius-md;
    padding: $spacing-md;
    
    .feature-icon {
      font-size: 24px;
      flex-shrink: 0;
    }
    
    strong {
      display: block;
      color: $color-text;
      margin-bottom: 4px;
    }
    
    p {
      margin: 0;
      color: $color-text-secondary;
      font-size: $font-size-sm;
    }
  }
}

// å¯¹æ¯”å—
.compare-block {
  margin-top: $spacing-md;
  
  .compare-item {
    padding: $spacing-sm $spacing-md;
    border-radius: $radius-sm;
    margin-bottom: $spacing-sm;
    
    .label {
      display: block;
      font-size: $font-size-xs;
      margin-bottom: 4px;
    }
    
    code {
      background: rgba(255, 255, 255, 0.8);
      padding: 4px 8px;
      border-radius: 4px;
      font-family: $font-family-code;
      font-size: $font-size-sm;
    }
    
    &.bad {
      background: #ffebee;
      .label { color: $color-error; }
    }
    
    &.good {
      background: #e8f5e9;
      .label { color: $color-success; }
    }
  }
}

.mt-md {
  margin-top: $spacing-md;
}
</style>

<template>
  <div class="knowledge-page">
    <h2>ğŸ”€ 8.2 åŠ¨æ€è·¯ç”±</h2>
    <p class="page-desc">åŠ¨æ€è·¯ç”±å…è®¸æˆ‘ä»¬ä½¿ç”¨åŠ¨æ€å‚æ•°åŒ¹é…ä¸åŒçš„è·¯å¾„ï¼Œæ˜¯æ„å»ºè¯¦æƒ…é¡µçš„æ ¸å¿ƒæŠ€æœ¯</p>

    <!-- æ¦‚å¿µè¯´æ˜ -->
    <KnowledgeCard title="ğŸ“– ä»€ä¹ˆæ˜¯åŠ¨æ€è·¯ç”±">
      <div class="concept-content">
        <div class="metaphor">
          <span class="icon">ğŸ¨</span>
          <div>
            <strong>é€šä¿—æ¯”å–»ï¼šé…’åº—æˆ¿é—´å·</strong>
            <p>å°±åƒé…’åº—æœ‰å¾ˆå¤šæˆ¿é—´ï¼ˆ101ã€102ã€103...ï¼‰ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä¸ºæ¯ä¸ªæˆ¿é—´å•ç‹¬è®¾ç½®è·¯çº¿ã€‚åªéœ€è¦ä¸€ä¸ªæ¨¡å¼ï¼š<code>/room/:id</code>ï¼Œå°±èƒ½åŒ¹é…æ‰€æœ‰æˆ¿é—´ï¼</p>
          </div>
        </div>
        <div class="definition">
          <strong>å®˜æ–¹å®šä¹‰ï¼š</strong>
          åŠ¨æ€è·¯ç”±å‚æ•°ä»¥å†’å· <code>:</code> å¼€å¤´ï¼ŒåŒ¹é…ç¬¦åˆæ¨¡å¼çš„è·¯å¾„ã€‚å‚æ•°å€¼ä¼šè¢«è®¾ç½®åˆ° <code>$route.params</code> ä¸­ã€‚
        </div>
      </div>
    </KnowledgeCard>

    <!-- æ ¸å¿ƒè¯­æ³• -->
    <KnowledgeCard title="ğŸ“ åŠ¨æ€è·¯ç”±è¯­æ³•">
      <table class="syntax-table">
        <thead>
          <tr>
            <th>æ¨¡å¼</th>
            <th>åŒ¹é…è·¯å¾„</th>
            <th>$route.params</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>/user/:id</code></td>
            <td>/user/123</td>
            <td>{ id: '123' }</td>
          </tr>
          <tr>
            <td><code>/user/:id/post/:postId</code></td>
            <td>/user/123/post/456</td>
            <td>{ id: '123', postId: '456' }</td>
          </tr>
          <tr>
            <td><code>/category/:type?</code></td>
            <td>/category æˆ– /category/tech</td>
            <td>{ type: undefined æˆ– 'tech' }</td>
          </tr>
          <tr>
            <td><code>/files/*</code></td>
            <td>/files/a/b/c</td>
            <td>{ pathMatch: 'a/b/c' }</td>
          </tr>
        </tbody>
      </table>
    </KnowledgeCard>

    <!-- è·å–å‚æ•°çš„æ–¹å¼ -->
    <KnowledgeCard title="ğŸ”§ è·å–åŠ¨æ€å‚æ•°çš„æ–¹å¼">
      <CodeBlock :code="paramAccessCode" language="javascript" />
    </KnowledgeCard>

    <!-- Demo 1 -->
    <KnowledgeCard title="ğŸ¯ Demo æ¼”ç¤º">
      <DemoBox 
        demoPath="router/dynamic-basic" 
        title="Demo 1: åŠ¨æ€è·¯ç”±åŸºç¡€" 
        :height="420"
      />
      
      <DemoBox 
        demoPath="router/dynamic-multiple" 
        title="Demo 2: å¤šä¸ªåŠ¨æ€å‚æ•°" 
        :height="400"
      />
      
      <DemoBox 
        demoPath="router/dynamic-watch" 
        title="Demo 3: å“åº”è·¯ç”±å‚æ•°å˜åŒ–" 
        :height="450"
      />
      
      <DemoBox 
        demoPath="router/dynamic-optional" 
        title="Demo 4: å¯é€‰å‚æ•°ä¸é€šé…ç¬¦" 
        :height="420"
      />
      
      <DemoBox 
        demoPath="router/dynamic-props" 
        title="Demo 5: Props è§£è€¦" 
        :height="400"
      />
    </KnowledgeCard>

    <!-- æ³¨æ„äº‹é¡¹ -->
    <TipBox type="warning" title="âš ï¸ é‡è¦æç¤º">
      <ul>
        <li><strong>ç»„ä»¶å¤ç”¨é—®é¢˜ï¼š</strong>å½“è·¯ç”±å‚æ•°å˜åŒ–æ—¶ï¼ˆå¦‚ /user/1 â†’ /user/2ï¼‰ï¼Œç»„ä»¶ä¸ä¼šé‡æ–°åˆ›å»ºï¼Œéœ€è¦ç”¨ watch ç›‘å¬ $route æˆ–ä½¿ç”¨ beforeRouteUpdate é’©å­</li>
        <li><strong>å‚æ•°éƒ½æ˜¯å­—ç¬¦ä¸²ï¼š</strong>$route.params.id æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œéœ€è¦æ—¶è¯·è½¬æ¢ä¸ºæ•°å­—</li>
        <li><strong>é€šé…ç¬¦è·¯ç”±æ”¾æœ€åï¼š</strong>path: '*' å¿…é¡»æ”¾åœ¨è·¯ç”±é…ç½®çš„æœ€åï¼Œå¦åˆ™ä¼šæ‹¦æˆªå…¶ä»–è·¯ç”±</li>
      </ul>
    </TipBox>

    <!-- æœ€ä½³å®è·µ -->
    <TipBox type="success" title="âœ… æœ€ä½³å®è·µ">
      <ul>
        <li>ä½¿ç”¨ props: true å°†å‚æ•°è§£è€¦ï¼Œç»„ä»¶æ›´æ˜“å¤ç”¨å’Œæµ‹è¯•</li>
        <li>å¯¹äºæ•°å­—ç±»å‹çš„ IDï¼Œåœ¨ç»„ä»¶ä¸­ä½¿ç”¨ parseInt æˆ– Number è½¬æ¢</li>
        <li>å–„ç”¨ watch ç›‘å¬ $route å˜åŒ–ï¼Œå¤„ç†æ•°æ®é‡æ–°åŠ è½½</li>
      </ul>
    </TipBox>
  </div>
</template>

<script>
import KnowledgeCard from '@/components/content/KnowledgeCard.vue'
import TipBox from '@/components/content/TipBox.vue'
import DemoBox from '@/components/demo/DemoBox.vue'
import CodeBlock from '@/components/demo/CodeBlock.vue'
import scrollTrackingMixin from '@/utils/scrollTrackingMixin'

export default {
  name: 'DynamicRoute',
  mixins: [scrollTrackingMixin],
  components: {
    KnowledgeCard,
    TipBox,
    DemoBox,
    CodeBlock
  },
  data() {
    return {
      paramAccessCode: `// æ–¹å¼1ï¼šåœ¨æ¨¡æ¿ä¸­ç›´æ¥ä½¿ç”¨
{{ $route.params.id }}

// æ–¹å¼2ï¼šåœ¨ç»„ä»¶ä¸­é€šè¿‡ this.$route è®¿é—®
export default {
  computed: {
    userId() {
      return this.$route.params.id
    }
  }
}

// æ–¹å¼3ï¼šä½¿ç”¨ props è§£è€¦ï¼ˆæ¨èï¼‰
// è·¯ç”±é…ç½®
{ path: '/user/:id', component: User, props: true }

// ç»„ä»¶ä¸­
export default {
  props: ['id'],  // ç›´æ¥ä½œä¸º prop ä½¿ç”¨
  template: '<div>ç”¨æˆ·ID: {{ id }}</div>'
}`
    }
  }
}
</script>

<style lang="scss" scoped>
.knowledge-page {
  max-width: 900px;
  margin: 0 auto;
  
  h2 {
    font-size: 28px;
    margin-bottom: 8px;
  }
  
  .page-desc {
    color: $color-text-secondary;
    margin-bottom: 24px;
  }
}

.concept-content {
  .metaphor {
    display: flex;
    gap: 16px;
    padding: 16px;
    background: linear-gradient(135deg, #e3f2fd, #f3e5f5);
    border-radius: 12px;
    margin-bottom: 16px;
    
    .icon {
      font-size: 36px;
    }
    
    strong {
      color: $color-text;
      display: block;
      margin-bottom: 4px;
    }
    
    p {
      color: $color-text-secondary;
      font-size: 14px;
      margin: 0;
    }
  }
  
  .definition {
    padding: 12px;
    background: $color-code-bg;
    border-radius: 8px;
    font-size: 14px;
  }
}

.syntax-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 14px;
  
  th, td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid $color-border;
  }
  
  th {
    background: $color-bg;
    font-weight: 600;
  }
  
  code {
    background: rgba(0, 122, 255, 0.1);
    padding: 2px 6px;
    border-radius: 4px;
    color: $color-primary;
  }
}
</style>
